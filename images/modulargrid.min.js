/*! ModularGrid */

!function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){$.ui=$.ui||{};$.ui.version="1.12.1";var orig,widgetUuid=0,widgetSlice=Array.prototype.slice;$.cleanData=(orig=$.cleanData,function(elems){var events,elem,i;for(i=0;null!=(elem=elems[i]);i++)try{(events=$._data(elem,"events"))&&events.remove&&$(elem).triggerHandler("remove")}catch(e){}orig(elems)}),$.widget=function(name,base,prototype){var existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0],fullName=namespace+"-"+(name=name.split(".")[1]);return prototype||(prototype=base,base=$.Widget),$.isArray(prototype)&&(prototype=$.extend.apply(null,[{}].concat(prototype))),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){if(!this._createWidget)return new constructor(options,element);arguments.length&&this._createWidget(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),(basePrototype=new base).options=$.widget.extend({},basePrototype.options),$.each(prototype,function(prop,value){$.isFunction(value)?proxiedPrototype[prop]=function(){function _super(){return base.prototype[prop].apply(this,arguments)}function _superApply(args){return base.prototype[prop].apply(this,args)}return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}():proxiedPrototype[prop]=value}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor&&basePrototype.widgetEventPrefix||name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor),constructor},$.widget.extend=function(target){for(var key,value,input=widgetSlice.call(arguments,1),inputIndex=0,inputLength=input.length;inputIndex<inputLength;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&void 0!==value&&($.isPlainObject(value)?target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):target[key]=value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=widgetSlice.call(arguments,1),returnValue=this;return isMethodCall?this.length||"instance"!==options?this.each(function(){var methodValue,instance=$.data(this,fullName);return"instance"===options?(returnValue=instance,!1):instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args))!==instance&&void 0!==methodValue?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0:$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}):returnValue=void 0:(args.length&&(options=$.widget.extend.apply(null,[options].concat(args))),this.each(function(){var instance=$.data(this,fullName);instance?(instance.option(options||{}),instance._init&&instance._init()):$.data(this,fullName,new object(options,this))})),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=widgetUuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),this.classesElementLookup={},element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){var that=this;this._destroy(),$.each(this.classesElementLookup,function(key,value){that._removeClass(value,key)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},key=(parts=key.split(".")).shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),1===arguments.length)return void 0===curOption[key]?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return void 0===this.options[key]?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return"classes"===key&&this._setOptionClasses(value),this.options[key]=value,"disabled"===key&&this._setOptionDisabled(value),this},_setOptionClasses:function(value){var classKey,elements,currentElements;for(classKey in value)currentElements=this.classesElementLookup[classKey],value[classKey]!==this.options.classes[classKey]&&currentElements&&currentElements.length&&(elements=$(currentElements.get()),this._removeClass(currentElements,classKey),elements.addClass(this._classes({element:elements,keys:classKey,classes:value,add:!0})))},_setOptionDisabled:function(value){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!value),value&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(options){var full=[],that=this;function processClassString(classes,checkOption){var current,i;for(i=0;i<classes.length;i++)current=that.classesElementLookup[classes[i]]||$(),current=options.add?$($.unique(current.get().concat(options.element.get()))):$(current.not(options.element).get()),that.classesElementLookup[classes[i]]=current,full.push(classes[i]),checkOption&&options.classes[classes[i]]&&full.push(options.classes[classes[i]])}return options=$.extend({element:this.element,classes:this.options.classes||{}},options),this._on(options.element,{remove:"_untrackClassesElement"}),options.keys&&processClassString(options.keys.match(/\S+/g)||[],!0),options.extra&&processClassString(options.extra.match(/\S+/g)||[]),full.join(" ")},_untrackClassesElement:function(event){var that=this;$.each(that.classesElementLookup,function(key,value){-1!==$.inArray(event.target,value)&&(that.classesElementLookup[key]=$(value.not(event.target).get()))})},_removeClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!1)},_addClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!0)},_toggleClass:function(element,keys,extra,add){add="boolean"==typeof add?add:extra;var shift="string"==typeof element||null===element,options={extra:shift?keys:extra,keys:shift?element:keys,element:shift?this.element:element,add:add};return options.element.toggleClass(this._classes(options),add),this},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){if(suppressDisabledCheck||!0!==instance.options.disabled&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.on(eventName,selector,handlerProxy):element.on(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.off(eventName).off(eventName),this.bindings=$(this.bindings.not(element).get()),this.focusable=$(this.focusable.not(element).get()),this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){var instance=this;return setTimeout(function(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)},delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){this._addClass($(event.currentTarget),null,"ui-state-hover")},mouseleave:function(event){this._removeClass($(event.currentTarget),null,"ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){this._addClass($(event.currentTarget),null,"ui-state-focus")},focusout:function(event){this._removeClass($(event.currentTarget),null,"ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},(event=$.Event(event)).type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&!1===callback.apply(this.element[0],[event].concat(data))||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){var hasOptions;"string"==typeof options&&(options={effect:options});var effectName=options?!0===options||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;"number"==typeof(options=options||{})&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()})}});$.widget,$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])}}),$.fn.scrollParent=function(includeHidden){var position=this.css("position"),excludeStaticParent="absolute"===position,overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);return(!excludeStaticParent||"static"!==parent.css("position"))&&overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(this[0].ownerDocument||document)},$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var mouseHandled=!1;$(document).on("mouseup",function(){mouseHandled=!1});$.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.on("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).on("click."+this.widgetName,function(event){if(!0===$.data(event.target,that.widgetName+".preventClickEvent"))return $.removeData(event.target,that.widgetName+".preventClickEvent"),event.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(event),this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel=!("string"!=typeof this.options.cancel||!event.target.nodeName)&&$(event.target).closest(this.options.cancel).length;return!(btnIsLeft&&!elIsCancel&&this._mouseCapture(event))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(event),!this._mouseStarted)?(event.preventDefault(),!0):(!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(event){return that._mouseMove(event)},this._mouseUpDelegate=function(event){return that._mouseUp(event)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),event.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button)return this._mouseUp(event);if(!event.which)if(event.originalEvent.altKey||event.originalEvent.ctrlKey||event.originalEvent.metaKey||event.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(event)}return(event.which||event.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(event),event.preventDefault()):(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,event),this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)),!this._mouseStarted)},_mouseUp:function(event){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(event)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,mouseHandled=!1,event.preventDefault()},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set)proto.plugins[i]=proto.plugins[i]||[],proto.plugins[i].push([option,set[i]])},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(set&&(allowDisconnected||instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType))for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}},$.ui.safeActiveElement=function(document){var activeElement;try{activeElement=document.activeElement}catch(error){activeElement=document.body}return activeElement||(activeElement=document.body),activeElement.nodeName||(activeElement=document.body),activeElement},$.ui.safeBlur=function(element){element&&"body"!==element.nodeName.toLowerCase()&&$(element).trigger("blur")};$.widget("ui.draggable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(key,value){this._super(key,value),"handle"===key&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(event){var o=this.options;return!(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(event),!!this.handle&&(this._blurActiveElement(event),this._blockFrames(!0===o.iframeFix?"iframe":o.iframeFix),!0))},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(event){var activeElement=$.ui.safeActiveElement(this.document[0]);$(event.target).closest(activeElement).length||$.ui.safeBlur(activeElement)},_mouseStart:function(event){var o=this.options;return this.helper=this._createHelper(event),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===$(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(event),this.originalPosition=this.position=this._generatePosition(event,!1),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),!1===this._trigger("start",event)?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this._mouseDrag(event,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event),!0)},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top}},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(event,!0),this.positionAbs=this._convertPositionTo("absolute"),!noPropagation){var ui=this._uiHash();if(!1===this._trigger("drag",event,ui))return this._mouseUp(new $.Event("mouseup",event)),!1;this.position=ui.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),!1},_mouseStop:function(event){var that=this,dropped=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event)),this.dropped&&(dropped=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||!0===this.options.revert||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==that._trigger("stop",event)&&that._clear()}):!1!==this._trigger("stop",event)&&this._clear(),!1},_mouseUp:function(event){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event),this.handleElement.is(event.target)&&this.element.trigger("focus"),$.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new $.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(event){return!this.options.handle||!!$(event.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),helperIsFunction&&helper[0]===this.element[0]&&this._setPositionRelative(),helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute"),helper},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_isRootNode:function(element){return/(html|body)/i.test(element.tagName)||element===this.document[0]},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollTop()),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];this.relativeContainer=null,o.containment?"window"!==o.containment?"document"!==o.containment?o.containment.constructor!==Array?("parent"===o.containment&&(o.containment=this.helper[0].parentNode),(ce=(c=$(o.containment))[0])&&(isUserScrollable=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c)):this.containment=o.containment:this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)*mod}},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;return scrollIsRootNode&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),constrainPosition&&(this.containment&&(this.relativeContainer?(co=this.relativeContainer.offset(),containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]):containment=this.containment,event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)),o.grid&&(top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left),"y"===o.axis&&(pageX=this.originalPageX),"x"===o.axis&&(pageY=this.originalPageY)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(type,event,ui){return ui=ui||this._uiHash(),$.ui.plugin.call(this,type,[event,ui,this],!0),/^(drag|start|stop)/.test(type)&&(this.positionAbs=this._convertPositionTo("absolute"),ui.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[],$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");sortable&&!sortable.options.disabled&&(draggable.sortables.push(sortable),sortable.refreshPositions(),sortable._trigger("activate",event,uiSortable))})},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=!1,$.each(draggable.sortables,function(){this.isOver?(this.isOver=0,draggable.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(event),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",event,uiSortable))})},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=!1,sortable=this;sortable.positionAbs=draggable.positionAbs,sortable.helperProportions=draggable.helperProportions,sortable.offset.click=draggable.offset.click,sortable._intersectsWith(sortable.containerCache)&&(innermostIntersecting=!0,$.each(draggable.sortables,function(){return this.positionAbs=draggable.positionAbs,this.helperProportions=draggable.helperProportions,this.offset.click=draggable.offset.click,this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])&&(innermostIntersecting=!1),innermostIntersecting})),innermostIntersecting?(sortable.isOver||(sortable.isOver=1,draggable._parent=ui.helper.parent(),sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",!0),sortable.options._helper=sortable.options.helper,sortable.options.helper=function(){return ui.helper[0]},event.target=sortable.currentItem[0],sortable._mouseCapture(event,!0),sortable._mouseStart(event,!0,!0),sortable.offset.click.top=draggable.offset.click.top,sortable.offset.click.left=draggable.offset.click.left,sortable.offset.parent.left-=draggable.offset.parent.left-sortable.offset.parent.left,sortable.offset.parent.top-=draggable.offset.parent.top-sortable.offset.parent.top,draggable._trigger("toSortable",event),draggable.dropped=sortable.element,$.each(draggable.sortables,function(){this.refreshPositions()}),draggable.currentItem=draggable.element,sortable.fromOutside=draggable),sortable.currentItem&&(sortable._mouseDrag(event),ui.position=sortable.position)):sortable.isOver&&(sortable.isOver=0,sortable.cancelHelperRemoval=!0,sortable.options._revert=sortable.options.revert,sortable.options.revert=!1,sortable._trigger("out",event,sortable._uiHash(sortable)),sortable._mouseStop(event,!0),sortable.options.revert=sortable.options._revert,sortable.options.helper=sortable.options._helper,sortable.placeholder&&sortable.placeholder.remove(),ui.helper.appendTo(draggable._parent),draggable._refreshOffsets(event),ui.position=draggable._generatePosition(event,!0),draggable._trigger("fromSortable",event),draggable.dropped=!1,$.each(draggable.sortables,function(){this.refreshPositions()}))})}}),$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;t.css("cursor")&&(o._cursor=t.css("cursor")),t.css("cursor",o.cursor)},stop:function(event,ui,instance){var o=instance.options;o._cursor&&$("body").css("cursor",o._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(event,ui,instance){var o=instance.options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(event,ui,i){var o=i.options,scrolled=!1,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];scrollParent!==document&&"HTML"!==scrollParent.tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+scrollParent.offsetHeight-event.pageY<o.scrollSensitivity?scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+scrollParent.offsetWidth-event.pageX<o.scrollSensitivity?scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}}),$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[],$(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--)r=(l=inst.snapElements[i].left-inst.margins.left)+inst.snapElements[i].width,b=(t=inst.snapElements[i].top-inst.margins.top)+inst.snapElements[i].height,x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)?(inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=!1):("inner"!==o.snapMode&&(ts=Math.abs(t-y2)<=d,bs=Math.abs(b-y1)<=d,ls=Math.abs(l-x2)<=d,rs=Math.abs(r-x1)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left)),first=ts||bs||ls||rs,"outer"!==o.snapMode&&(ts=Math.abs(t-y1)<=d,bs=Math.abs(b-y2)<=d,ls=Math.abs(l-x1)<=d,rs=Math.abs(r-x2)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left)),!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=ts||bs||ls||rs||first)}}),$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});group.length&&(min=parseInt($(group[0]).css("zIndex"),10)||0,$(group).each(function(i){$(this).css("zIndex",min+i)}),this.css("zIndex",min+group.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(event,ui,instance){var o=instance.options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}});$.ui.draggable;$.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)},this.proportions=function(){if(!arguments.length)return proportions||(proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});proportions=arguments[0]},this._addToManager(o.scope),o.addClasses&&this._addClass("ui-droppable")},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[],$.ui.ddmanager.droppables[scope].push(this)},_splice:function(drop){for(var i=0;i<drop.length;i++)drop[i]===this&&drop.splice(i,1)},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop)},_setOption:function(key,value){if("accept"===key)this.accept=$.isFunction(value)?value:function(d){return d.is(value)};else if("scope"===key){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop),this._addToManager(value)}this._super(key,value)},_activate:function(event){var draggable=$.ui.ddmanager.current;this._addActiveClass(),draggable&&this._trigger("activate",event,this.ui(draggable))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this._removeActiveClass(),draggable&&this._trigger("deactivate",event,this.ui(draggable))},_over:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._addHoverClass(),this._trigger("over",event,this.ui(draggable)))},_out:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._removeHoverClass(),this._trigger("out",event,this.ui(draggable)))},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=!1;return!(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],draggable.currentItem||draggable.element)&&intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event))return childrenIntersection=!0,!1}),!childrenIntersection&&(!!this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",event,this.ui(draggable)),this.element)))},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var intersect=$.ui.intersect=function(){function isOverAxis(x,reference,size){return x>=reference&&x<reference+size}return function(draggable,droppable,toleranceMode,event){if(!droppable.offset)return!1;var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return l<=x1&&x2<=r&&t<=y1&&y2<=b;case"intersect":return l<x1+draggable.helperProportions.width/2&&x2-draggable.helperProportions.width/2<r&&t<y1+draggable.helperProportions.height/2&&y2-draggable.helperProportions.height/2<b;case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return(y1>=t&&y1<=b||y2>=t&&y2<=b||y1<t&&y2>b)&&(x1>=l&&x1<=r||x2>=l&&x2<=r||x1<l&&x2>r);default:return!1}}}();$.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++)if(!(m[i].options.disabled||t&&!m[i].accept.call(m[i].element[0],t.currentItem||t.element))){for(j=0;j<list.length;j++)if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop}m[i].visible="none"!==m[i].element.css("display"),m[i].visible&&("mousedown"===type&&m[i]._activate.call(m[i],event),m[i].offset=m[i].element.offset(),m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}))}},drop:function(draggable,event){var dropped=!1;return $.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&intersect(draggable,this,this.options.tolerance,event)&&(dropped=this._drop.call(this,event)||dropped),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,event)))}),dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").on("scroll.droppable",function(){draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)})},drag:function(draggable,event){draggable.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(draggable,event),$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var parentInstance,scope,parent,intersects=intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":intersects&&!this.isover?"isover":null;c&&(this.options.greedy&&(scope=this.options.scope,(parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope})).length&&((parentInstance=$(parent[0]).droppable("instance")).greedyChild="isover"===c)),parentInstance&&"isover"===c&&(parentInstance.isover=!1,parentInstance.isout=!0,parentInstance._out.call(parentInstance,event)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,event),parentInstance&&"isout"===c&&(parentInstance.isout=!1,parentInstance.isover=!0,parentInstance._over.call(parentInstance,event)))}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").off("scroll.droppable"),draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)}},!1!==$.uiBackCompat&&$.widget("ui.droppable",$.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}});$.ui.droppable}),function($){function CollisionCoords(proto,containment){if(proto)if("offset"in proto){var d=proto.data("jquery-collision-coordinates");if(d)this.x1=d.x1,this.y1=d.y1,this.x2=d.x2,this.y2=d.y2;else if(containment&&containment.length&&containment.length>=4)this.x1=containment[0],this.y1=containment[1],this.x2=containment[2]+proto.outerWidth(!0),this.y2=containment[3]+proto.outerHeight(!0);else if(proto.parent().length<=0)this.x1=parseInt(proto.css("left"))||0,this.y1=parseInt(proto.css("top"))||0,this.x2=parseInt(proto.css("width"))||0,this.y2=parseInt(proto.css("height"))||0,this.x2+=this.x1,this.x2+=(parseInt(proto.css("margin-left"))||0)+(parseInt(proto.css("border-left"))||0)+(parseInt(proto.css("padding-left"))||0)+(parseInt(proto.css("padding-right"))||0)+(parseInt(proto.css("border-right"))||0)+(parseInt(proto.css("margin-right"))||0),this.y2+=this.y1,this.y2+=(parseInt(proto.css("margin-top"))||0)+(parseInt(proto.css("border-top"))||0)+(parseInt(proto.css("padding-top"))||0)+(parseInt(proto.css("padding-bottom"))||0)+(parseInt(proto.css("border-bottom"))||0)+(parseInt(proto.css("margin-bottom"))||0);else{var o=proto.offset();this.x1=o.left-(parseInt(proto.css("margin-left"))||0),this.y1=o.top-(parseInt(proto.css("margin-top"))||0),this.x2=this.x1+proto.outerWidth(!0),this.y2=this.y1+proto.outerHeight(!0)}this.proto=proto}else"x1"in proto&&(this.x1=proto.x1,this.y1=proto.y1,this.x2=proto.x2,this.y2=proto.y2,this.proto=proto);else this.x1=this.y1=this.x2=this.y2=0,this.proto=null;"dir"in proto&&(this.dir=proto.dir),this.x1=Math.ceil(this.x1)+4,this.x2=Math.floor(this.x2)-2}function Collision(targetNode,obstacleNode,overlapCoords,overlapType){this.target=targetNode,this.obstacle=obstacleNode,this.overlap=overlapCoords,this.overlapType=overlapType}function CollisionFactory(targets,obstacles,containment){this.targets=targets,this.obstacles=obstacles,this.collisions=null,this.cache=null,this.containment=containment||null}function makeCoordsArray(j){return $(j).get().map(function(e,i,a){return new CollisionCoords($(e))})}CollisionCoords.prototype.innerContainer=function(){var clone=new CollisionCoords(this);return this.proto.css&&(clone.x1+=parseInt(this.proto.css("margin-left"))||0,clone.x1+=parseInt(this.proto.css("border-left"))||0,clone.x1+=parseInt(this.proto.css("padding-left"))||0,clone.x2-=parseInt(this.proto.css("padding-right"))||0,clone.x2-=parseInt(this.proto.css("border-right"))||0,clone.x2-=parseInt(this.proto.css("margin-right"))||0,clone.y1+=parseInt(this.proto.css("margin-top"))||0,clone.y1+=parseInt(this.proto.css("border-top"))||0,clone.y1+=parseInt(this.proto.css("padding-top"))||0,clone.y2-=parseInt(this.proto.css("padding-bottom"))||0,clone.y2-=parseInt(this.proto.css("border-bottom"))||0,clone.y2-=parseInt(this.proto.css("margin-bottom"))||0),clone},CollisionCoords.prototype.move=function(dx,dy){return this.x1+=dx,this.x2+=dx,this.y1+=dy,this.y2+=dy,this},CollisionCoords.prototype.update=function(obj){if("x1"in obj&&(this.x1=obj.x1),"x2"in obj&&(this.x1=obj.x2),"y1"in obj&&(this.x1=obj.y1),"y2"in obj&&(this.x1=obj.y2),"left"in obj){var w=this.x2-this.x1;this.x1=obj.left,this.x2=this.x1+w}if("top"in obj){var h=this.y2-this.y1;this.y1=obj.top,this.y2=this.y1+h}if("offset"in obj){var o=obj.offset();this.update(o),this.x2=this.x1+obj.width(),this.y2=this.y1+obj.height()}return"dir"in obj&&(this.x1=obj.dir),this},CollisionCoords.prototype.width=function(){return this.x2-this.x1},CollisionCoords.prototype.height=function(){return this.y2-this.y1},CollisionCoords.prototype.centerx=function(){return(this.x1+this.x2)/2},CollisionCoords.prototype.centery=function(){return(this.y1+this.y2)/2},CollisionCoords.prototype.toString=function(){return(this.proto.get?"#"+this.proto.get(0).id:"")+"["+[this.x1,this.y1,this.x2,this.y2].join(",")+"]"},CollisionCoords.EPSILON=.001,CollisionCoords.prototype.containsPoint=function(x,y,inclusive){inclusive||(inclusive=!1);var epsilon=(inclusive?-1:1)*CollisionCoords.EPSILON;return x>this.x1+epsilon&&x<this.x2-epsilon&&y>this.y1+epsilon&&y<this.y2-epsilon},CollisionCoords.prototype.overlaps=function(other,inclusive){var hit=this._overlaps(other,inclusive);return hit.length>0?hit:((hit=other._overlaps(this,inclusive)).length>0&&(hit[0].dir="Inside"==hit[0].dir?"Outside":"Outside"==hit[0].dir?"Inside":"N"==hit[0].dir?"S":"S"==hit[0].dir?"N":"W"==hit[0].dir?"E":"E"==hit[0].dir?"W":"NE"==hit[0].dir?"SW":"SW"==hit[0].dir?"NE":"SE"==hit[0].dir?"NW":"NW"==hit[0].dir?"SE":void 0),hit||[])},CollisionCoords.prototype._overlaps=function(other,inclusive){var c1=other;inclusive||(inclusive=!1);for(var ax=c1.centerx(),ay=c1.centery(),points=[[c1.x1,c1.y1,"SE"],[c1.x2,c1.y1,"SW"],[c1.x2,c1.y2,"NW"],[c1.x1,c1.y2,"NE"],[ax,c1.y1,"S"],[c1.x2,ay,"W"],[ax,c1.y2,"N"],[c1.x1,ay,"E"],[ax,ay,void 0]],hit=null,dirs={NW:!1,N:!1,NE:!1,E:!1,SE:!1,S:!1,SW:!1,W:!1},i=0;i<points.length;i++)if(this.containsPoint(points[i][0],points[i][1],inclusive)){if(points[i][2]&&(dirs[points[i][2]]=!0),hit)continue;hit=[new CollisionCoords({x1:Math.max(c1.x1,this.x1),y1:Math.max(c1.y1,this.y1),x2:Math.min(c1.x2,this.x2),y2:Math.min(c1.y2,this.y2),dir:points[i][2]})]}return hit&&(dirs.NW&&dirs.NE&&(hit[0].dir="N"),dirs.NE&&dirs.SE&&(hit[0].dir="E"),dirs.SE&&dirs.SW&&(hit[0].dir="S"),dirs.SW&&dirs.NW&&(hit[0].dir="W"),dirs.NW&&dirs.NE&&dirs.SE&&dirs.SW&&(hit[0].dir="Outside"),dirs.NW||dirs.NE||dirs.SE||dirs.SW||dirs.N||dirs.E||dirs.S||dirs.W||(hit[0].dir="Inside")),hit||[]},CollisionCoords.prototype._protrusion=function(area,dir,list){var o=this.overlaps(new CollisionCoords(area),!1);return o.length<=0?list:(o[0].dir=dir,list.push(o[0]),list)},CollisionCoords.prototype.protrusions=function(container){var list=[],n=Number.NEGATIVE_INFINITY,p=Number.POSITIVE_INFINITY,l=container.x1,r=container.x2,t=container.y1,b=container.y2;return list=this._protrusion({x1:l,y1:n,x2:r,y2:t},"N",list),list=this._protrusion({x1:r,y1:n,x2:p,y2:t},"NE",list),list=this._protrusion({x1:r,y1:t,x2:p,y2:b},"E",list),list=this._protrusion({x1:r,y1:b,x2:p,y2:p},"SE",list),list=this._protrusion({x1:l,y1:b,x2:r,y2:p},"S",list),list=this._protrusion({x1:n,y1:b,x2:l,y2:p},"SW",list),list=this._protrusion({x1:n,y1:t,x2:l,y2:b},"W",list),list=this._protrusion({x1:n,y1:n,x2:l,y2:t},"NW",list)},Collision.prototype.distance=function(other){var tc=c.target,oc=c.overlap;return Math.sqrt((tc.centerx()-oc.centerx())*(tc.centerx()-oc.centerx())+(tc.centery()-oc.centery())*(tc.centery()-oc.centery()))},CollisionFactory.prototype.getCollisions=function(overlapType){if(null!==this.collisions)return this.collisions;if(this.cache={},this.collisions=[],overlapType||(overlapType="collision"),"collision"!=overlapType&&"protrusion"!=overlapType)return[];for(var c=[],t=this.targets,o=this.obstacles,ti=0;ti<t.length;ti++)for(var tc=t[ti],oi=0;oi<o.length;oi++)for(var oc=o[oi],ol="collision"==overlapType?tc.overlaps(oc):tc.protrusions(oc.innerContainer()),oli=0;oli<ol.length;oli++)c.push(new Collision(t[ti],o[oi],ol[oli],overlapType));return this.collisions=c,c},$.fn.collision=function(selector,options){options||(options={});var mode="collision",as=null,cd=null,od=null,dd=null,rel="body";"protrusion"==options.mode&&(mode=options.mode),options.as&&(as=options.as),options.colliderData&&(cd=options.colliderData),options.obstacleData&&(od=options.obstacleData),options.directionData&&(dd=options.directionData),options.relative&&(rel=options.relative);var ov=new CollisionFactory(makeCoordsArray(this),makeCoordsArray(selector)).getCollisions(mode);return function(array){for(var j=$(),i=0;i<array.length;i++)j=j.add(array[i]);return j}(as?ov.map(function(e,i,a){var xoff=e.overlap.x1,yoff=e.overlap.y1;if(rel&&"body"!=rel){var r=$("collider"==rel?e.target.proto:"obstacle"==rel?e.obstacle.proto:rel);if(r.length>0){var roff=r.offset();xoff-=roff.left,yoff-=roff.top}}var c=$(as).offset({left:xoff,top:yoff}).width(e.overlap.width()).height(e.overlap.height());return cd&&c.data(cd,$(e.target.proto)),od&&c.data(od,$(e.obstacle.proto)),dd&&e.overlap.dir&&c.data(dd,e.overlap.dir),c}):ov.map(function(e,i,a){return e.obstacle.proto}))}}(jQuery),function($){if($.support.touch="ontouchend"in document,$.support.touch){var touchHandled,mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,_mouseDestroy=mouseProto._mouseDestroy;mouseProto._touchStart=function(event){!touchHandled&&this._mouseCapture(event.originalEvent.changedTouches[0])&&(touchHandled=!0,this._touchMoved=!1,simulateMouseEvent(event,"mouseover"),simulateMouseEvent(event,"mousemove"),simulateMouseEvent(event,"mousedown"))},mouseProto._touchMove=function(event){touchHandled&&(this._touchMoved=!0,simulateMouseEvent(event,"mousemove"))},mouseProto._touchEnd=function(event){touchHandled&&(simulateMouseEvent(event,"mouseup"),simulateMouseEvent(event,"mouseout"),this._touchMoved||simulateMouseEvent(event,"click"),touchHandled=!1)},mouseProto._mouseInit=function(){this.element.bind({touchstart:$.proxy(this,"_touchStart"),touchmove:$.proxy(this,"_touchMove"),touchend:$.proxy(this,"_touchEnd")}),_mouseInit.call(this)},mouseProto._mouseDestroy=function(){this.element.unbind({touchstart:$.proxy(this,"_touchStart"),touchmove:$.proxy(this,"_touchMove"),touchend:$.proxy(this,"_touchEnd")}),_mouseDestroy.call(this)}}function simulateMouseEvent(event,simulatedType){if(!(event.originalEvent.touches.length>1)){event.preventDefault();var touch=event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent("MouseEvents");simulatedEvent.initMouseEvent(simulatedType,!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),event.target.dispatchEvent(simulatedEvent)}}}(jQuery),function($){"use strict";var toggle="[data-toggle=dropdown]",Dropdown=function(element){var $el=$(element).on("click.dropdown.data-api",this.toggle);$("html").on("click.dropdown.data-api",function(){$el.parent().removeClass("open")})};function clearMenus(){$(".dropdown-backdrop").remove(),$(toggle).each(function(){getParent($(this)).removeClass("open")})}function getParent($this){var $parent,selector=$this.attr("data-target");return selector||(selector=(selector=$this.attr("href"))&&/#/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,"")),($parent=selector&&$(selector))&&$parent.length||($parent=$this.parent()),$parent}Dropdown.prototype={constructor:Dropdown,toggle:function(e){var $parent,isActive,$this=$(this);if(!$this.is(".disabled, :disabled"))return isActive=($parent=getParent($this)).hasClass("open"),clearMenus(),isActive||("ontouchstart"in document.documentElement&&$('<div class="dropdown-backdrop"/>').insertBefore($(this)).on("click",clearMenus),$parent.toggleClass("open")),$this.focus(),!1},keydown:function(e){var $this,$items,$parent,isActive,index;if(/(38|40|27)/.test(e.keyCode)&&($this=$(this),e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled"))){if(!(isActive=($parent=getParent($this)).hasClass("open"))||isActive&&27==e.keyCode)return 27==e.which&&$parent.find(toggle).focus(),$this.click();($items=$("[role=menu] li:not(.divider):visible a",$parent)).length&&(index=$items.index($items.filter(":focus")),38==e.keyCode&&index>0&&index--,40==e.keyCode&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).focus())}}};var old=$.fn.dropdown;$.fn.dropdown=function(option){return this.each(function(){var $this=$(this),data=$this.data("dropdown");data||$this.data("dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})},$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.dropdown.data-api",clearMenus).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.dropdown.data-api",toggle+", [role=menu]",Dropdown.prototype.keydown)}(window.jQuery),function($){"use strict";$(function(){var transitionEnd;$.support.transition=(transitionEnd=function(){var name,el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(name in transEndEventNames)if(void 0!==el.style[name])return transEndEventNames[name]}())&&{end:transitionEnd}})}(window.jQuery),function($){"use strict";var Typeahead=function(element,options){this.$element=$(element),this.options=$.extend({},$.fn.typeahead.defaults,options),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=$(this.options.menu),this.shown=!1,this.listen()};Typeahead.prototype={constructor:Typeahead,select:function(){var val=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(val)).change(),this.hide()},updater:function(item){return item},show:function(){var pos=$.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:pos.top+pos.height,left:pos.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(event){var items;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(items=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source)?this.process(items):this},process:function(items){var that=this;return items=$.grep(items,function(item){return that.matcher(item)}),(items=this.sorter(items)).length?this.render(items.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(item){return~item.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(items){for(var item,beginswith=[],caseSensitive=[],caseInsensitive=[];item=items.shift();)item.toLowerCase().indexOf(this.query.toLowerCase())?~item.indexOf(this.query)?caseSensitive.push(item):caseInsensitive.push(item):beginswith.push(item);return beginswith.concat(caseSensitive,caseInsensitive)},highlighter:function(item){var query=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return item.replace(new RegExp("("+query+")","ig"),function($1,match){return"<strong>"+match+"</strong>"})},render:function(items){var that=this;return(items=$(items).map(function(i,item){return(i=$(that.options.item).attr("data-value",item)).find("a").html(that.highlighter(item)),i[0]})).first().addClass("active"),this.$menu.html(items),this},next:function(event){var next=this.$menu.find(".active").removeClass("active").next();next.length||(next=$(this.$menu.find("li")[0])),next.addClass("active")},prev:function(event){var prev=this.$menu.find(".active").removeClass("active").prev();prev.length||(prev=this.$menu.find("li").last()),prev.addClass("active")},listen:function(){this.$element.on("focus",$.proxy(this.focus,this)).on("blur",$.proxy(this.blur,this)).on("keypress",$.proxy(this.keypress,this)).on("keyup",$.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",$.proxy(this.keydown,this)),this.$menu.on("click",$.proxy(this.click,this)).on("mouseenter","li",$.proxy(this.mouseenter,this)).on("mouseleave","li",$.proxy(this.mouseleave,this))},eventSupported:function(eventName){var isSupported=eventName in this.$element;return isSupported||(this.$element.setAttribute(eventName,"return;"),isSupported="function"==typeof this.$element[eventName]),isSupported},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()}},keydown:function(e){this.suppressKeyPressRepeat=~$.inArray(e.keyCode,[40,38,9,13,27]),this.move(e)},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),$(e.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var old=$.fn.typeahead;$.fn.typeahead=function(option){return this.each(function(){var $this=$(this),data=$this.data("typeahead"),options="object"==typeof option&&option;data||$this.data("typeahead",data=new Typeahead(this,options)),"string"==typeof option&&data[option]()})},$.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},$.fn.typeahead.Constructor=Typeahead,$.fn.typeahead.noConflict=function(){return $.fn.typeahead=old,this},$(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(e){var $this=$(this);$this.data("typeahead")||$this.typeahead($this.data())})}(window.jQuery),function($){"use strict";var Button=function(element,options){this.$element=$(element),this.options=$.extend({},$.fn.button.defaults,options)};Button.prototype.setState=function(state){var d="disabled",$el=this.$element,data=$el.data(),val=$el.is("input")?"val":"html";state+="Text",data.resetText||$el.data("resetText",$el[val]()),$el[val](data[state]||this.options[state]),setTimeout(function(){"loadingText"==state?$el.addClass(d).attr(d,d):$el.removeClass(d).removeAttr(d)},0)},Button.prototype.toggle=function(){var $parent=this.$element.closest('[data-toggle="buttons-radio"]');$parent&&$parent.find(".active").removeClass("active"),this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=function(option){return this.each(function(){var $this=$(this),data=$this.data("button"),options="object"==typeof option&&option;data||$this.data("button",data=new Button(this,options)),"toggle"==option?data.toggle():option&&data.setState(option)})},$.fn.button.defaults={loadingText:"loading..."},$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.button.data-api","[data-toggle^=button]",function(e){var $btn=$(e.target);$btn.hasClass("btn")||($btn=$btn.closest(".btn")),$btn.button("toggle")})}(window.jQuery),function($){"use strict";var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},$.fn.collapse.defaults,options),this.options.parent&&(this.$parent=$(this.options.parent)),this.options.toggle&&this.toggle()};Collapse.prototype={constructor:Collapse,dimension:function(){return this.$element.hasClass("width")?"width":"height"},show:function(){var dimension,scroll,actives,hasData;if(!this.transitioning&&!this.$element.hasClass("in")){if(dimension=this.dimension(),scroll=$.camelCase(["scroll",dimension].join("-")),(actives=this.$parent&&this.$parent.find("> .accordion-group > .in"))&&actives.length){if((hasData=actives.data("collapse"))&&hasData.transitioning)return;actives.collapse("hide"),hasData||actives.data("collapse",null)}this.$element[dimension](0),this.transition("addClass",$.Event("show"),"shown"),$.support.transition&&this.$element[dimension](this.$element[0][scroll])}},hide:function(){var dimension;!this.transitioning&&this.$element.hasClass("in")&&(dimension=this.dimension(),this.reset(this.$element[dimension]()),this.transition("removeClass",$.Event("hide"),"hidden"),this.$element[dimension](0))},reset:function(size){var dimension=this.dimension();return this.$element.removeClass("collapse")[dimension](size||"auto")[0].offsetWidth,this.$element[null!==size?"addClass":"removeClass"]("collapse"),this},transition:function(method,startEvent,completeEvent){var that=this,complete=function(){"show"==startEvent.type&&that.reset(),that.transitioning=0,that.$element.trigger(completeEvent)};this.$element.trigger(startEvent),startEvent.isDefaultPrevented()||(this.transitioning=1,this.$element[method]("in"),$.support.transition&&this.$element.hasClass("collapse")?this.$element.one($.support.transition.end,complete):complete())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var old=$.fn.collapse;$.fn.collapse=function(option){return this.each(function(){var $this=$(this),data=$this.data("collapse"),options=$.extend({},$.fn.collapse.defaults,$this.data(),"object"==typeof option&&option);data||$this.data("collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})},$.fn.collapse.defaults={toggle:!0},$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.collapse.data-api","[data-toggle=collapse]",function(e){var href,$this=$(this),target=$this.attr("data-target")||e.preventDefault()||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""),option=$(target).data("collapse")?"toggle":$this.data();$this[$(target).hasClass("in")?"addClass":"removeClass"]("collapsed"),$(target).collapse(option)})}(window.jQuery),function($){"use strict";var Modal=function(element,options){this.options=options,this.$element=$(element).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};Modal.prototype={constructor:Modal,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var that=this,e=$.Event("show");this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(document.body),that.$element.show(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus(),transition?that.$element.one($.support.transition.end,function(){that.$element.focus().trigger("shown")}):that.$element.focus().trigger("shown")}))},hide:function(e){e&&e.preventDefault();e=$.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),$(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),$.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var that=this;$(document).on("focusin.modal",function(e){that.$element[0]===e.target||that.$element.has(e.target).length||that.$element.focus()})},escape:function(){var that=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&that.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end),that.hideModal()},500);this.$element.one($.support.transition.end,function(){clearTimeout(timeout),that.hideModal()})},hideModal:function(){var that=this;this.$element.hide(),this.backdrop(function(){that.removeBackdrop(),that.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(callback){var animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one($.support.transition.end,callback):callback()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,callback):callback()):callback&&callback()}};var old=$.fn.modal;$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data("modal"),options=$.extend({},$.fn.modal.defaults,$this.data(),"object"==typeof option&&option);data||$this.data("modal",data=new Modal(this,options)),"string"==typeof option?data[option]():options.show&&data.show()})},$.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());e.preventDefault(),$target.modal(option).one("hide",function(){$this.focus()})})}(window.jQuery),function($){"use strict";var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.prototype.close=function(e){var $parent,$this=$(this),selector=$this.attr("data-target");function removeElement(){$parent.trigger("closed").remove()}selector||(selector=(selector=$this.attr("href"))&&selector.replace(/.*(?=#[^\s]*$)/,"")),$parent=$(selector),e&&e.preventDefault(),$parent.length||($parent=$this.hasClass("alert")?$this:$this.parent()),$parent.trigger(e=$.Event("close")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.on($.support.transition.end,removeElement):removeElement())};var old=$.fn.alert;$.fn.alert=function(option){return this.each(function(){var $this=$(this),data=$this.data("alert");data||$this.data("alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)})},$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.alert.data-api",dismiss,Alert.prototype.close)}(window.jQuery),function($){"use strict";var Tooltip=function(element,options){this.init("tooltip",element,options)};Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut,triggers,trigger,i;for(this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.enabled=!0,i=(triggers=this.options.trigger.split(" ")).length;i--;)"click"==(trigger=triggers[i])?this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this)):"manual"!=trigger&&(eventIn="hover"==trigger?"mouseenter":"focus",eventOut="hover"==trigger?"mouseleave":"blur",this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this)));this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(options){return(options=$.extend({},$.fn[this.type].defaults,this.$element.data(),options)).delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},enter:function(e){var self,defaults=$.fn[this.type].defaults,options={};if(this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)},this),!(self=$(e.currentTarget)[this.type](options).data(this.type)).options.delay||!self.options.delay.show)return self.show();clearTimeout(this.timeout),self.hoverState="in",this.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!self.options.delay||!self.options.delay.hide)return self.hide();self.hoverState="out",this.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)},show:function(){var $tip,pos,actualWidth,actualHeight,placement,tp,e=$.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;switch($tip=this.tip(),this.setContent(),this.options.animation&&$tip.addClass("fade"),placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,$tip.detach().css({top:0,left:0,display:"block"}),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element),pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,placement){case"bottom":tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2};break;case"top":tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2};break;case"left":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth};break;case"right":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}}this.applyPlacement(tp,placement),this.$element.trigger("shown")}},applyPlacement:function(offset,placement){var actualWidth,actualHeight,delta,replace,$tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight;$tip.offset(offset).addClass(placement).addClass("in"),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight,replace=!0),"bottom"==placement||"top"==placement?(delta=0,offset.left<0&&(delta=-2*offset.left,offset.left=0,$tip.offset(offset),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight),this.replaceArrow(delta-width+actualWidth,actualWidth,"left")):this.replaceArrow(actualHeight-height,actualHeight,"top"),replace&&$tip.offset(offset)},replaceArrow:function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},setContent:function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},hide:function(){var timeout,$tip=this.tip(),e=$.Event("hide");if(this.$element.trigger(e),!e.isDefaultPrevented())return $tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?(timeout=setTimeout(function(){$tip.off($.support.transition.end).detach()},500),$tip.one($.support.transition.end,function(){clearTimeout(timeout),$tip.detach()})):$tip.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var el=this.$element[0];return $.extend({},"function"==typeof el.getBoundingClientRect?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())},getTitle:function(){var $e=this.$element,o=this.options;return $e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},tip:function(){return this.$tip=this.$tip||$(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var self=e?$(e.currentTarget)[this.type](this._options).data(this.type):this;self.tip().hasClass("in")?self.hide():self.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("tooltip"),options="object"==typeof option&&option;data||$this.data("tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]()})},$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!0,container:!1},$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(window.jQuery),function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype,{constructor:Popover,setContent:function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content")[this.options.html?"html":"text"](content),$tip.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var $e=this.$element,o=this.options;return("function"==typeof o.content?o.content.call($e[0]):o.content)||$e.attr("data-content")},tip:function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var old=$.fn.popover;$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("popover"),options="object"==typeof option&&option;data||$this.data("popover",data=new Popover(this,options)),"string"==typeof option&&data[option]()})},$.fn.popover.Constructor=Popover,$.fn.popover.defaults=$.extend({},$.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(window.jQuery),function($){var methods={init:function(settings){return this.each(function(){var $this=$(this).empty();this.opt=$.extend(!0,{},$.fn.raty.defaults,settings),$this.data("settings",this.opt),this.opt.number=methods.between(this.opt.number,0,20),"/"!=this.opt.path.substring(this.opt.path.length-1,this.opt.path.length)&&(this.opt.path+="/"),"function"==typeof this.opt.score&&(this.opt.score=this.opt.score.call(this)),this.opt.score&&(this.opt.score=methods.between(this.opt.score,0,this.opt.number));for(var i=1;i<=this.opt.number;i++)$("<img />",{src:this.opt.path+(!this.opt.score||this.opt.score<i?this.opt.starOff:this.opt.starOn),alt:i,title:i<=this.opt.hints.length&&null!==this.opt.hints[i-1]?this.opt.hints[i-1]:i}).appendTo(this),this.opt.space&&$this.append(i<this.opt.number?"&#160;":"");this.stars=$this.children('img:not(".raty-cancel")'),this.score=$("<input />",{type:"hidden",name:this.opt.scoreName}).appendTo(this),this.opt.score&&this.opt.score>0&&(this.score.val(this.opt.score),methods.roundStar.call(this,this.opt.score)),this.opt.iconRange&&methods.fill.call(this,this.opt.score),methods.setTarget.call(this,this.opt.score,this.opt.targetKeep);var space=this.opt.space?4:0,width=this.opt.width||this.opt.number*this.opt.size+this.opt.number*space;this.opt.cancel&&(this.cancel=$("<img />",{src:this.opt.path+this.opt.cancelOff,alt:"x",title:this.opt.cancelHint,class:"raty-cancel"}),"left"==this.opt.cancelPlace?$this.prepend("&#160;").prepend(this.cancel):$this.append("&#160;").append(this.cancel),width+=this.opt.size+space),this.opt.readOnly?(methods.fixHint.call(this),this.cancel&&this.cancel.hide()):($this.css("cursor","pointer"),methods.bindAction.call(this)),$this.css("width",width)})},between:function(value,min,max){return Math.min(Math.max(parseFloat(value),min),max)},bindAction:function(){var self=this,$this=$(self);$this.mouseleave(function(){var score=self.score.val()||void 0;methods.initialize.call(self,score),methods.setTarget.call(self,score,self.opt.targetKeep),self.opt.mouseover&&self.opt.mouseover.call(self,score)});var action=self.opt.half?"mousemove":"mouseover";self.opt.cancel&&self.cancel.mouseenter(function(){$(this).attr("src",self.opt.path+self.opt.cancelOn),self.stars.attr("src",self.opt.path+self.opt.starOff),methods.setTarget.call(self,null,!0),self.opt.mouseover&&self.opt.mouseover.call(self,null)}).mouseleave(function(){$(this).attr("src",self.opt.path+self.opt.cancelOff),self.opt.mouseover&&self.opt.mouseover.call(self,self.score.val()||null)}).click(function(evt){self.score.removeAttr("value"),self.opt.click&&self.opt.click.call(self,null,evt)}),self.stars.bind(action,function(evt){var value=parseInt(this.alt,10);if(self.opt.half){var position=parseFloat((evt.pageX-$(this).offset().left)/self.opt.size),diff=position>.5?1:.5;value=parseFloat(this.alt)-1+diff,methods.fill.call(self,value),self.opt.precision&&(value=value-diff+position),methods.showHalf.call(self,value)}else methods.fill.call(self,value);$this.data("score",value),methods.setTarget.call(self,value,!0),self.opt.mouseover&&self.opt.mouseover.call(self,value,evt)}).click(function(evt){self.score.val(self.opt.half||self.opt.precision?$this.data("score"):this.alt),self.opt.click&&self.opt.click.call(self,self.score.val(),evt)})},cancel:function(isClick){return $(this).each(function(){if(!0===$(this).data("readonly"))return this;isClick?methods.click.call(this,null):methods.score.call(this,null),this.score.removeAttr("value")})},click:function(score){return $(this).each(function(){if(!0===$(this).data("readonly"))return this;methods.initialize.call(this,score),this.opt.click?this.opt.click.call(this,score):methods.error.call(this,'you must add the "click: function(score, evt) { }" callback.'),methods.setTarget.call(this,score,!0)})},error:function(message){$(this).html(message),$.error(message)},fill:function(score){for(var $star,star,icon,number=this.stars.length,count=0,i=1;i<=number;i++)$star=this.stars.eq(i-1),this.opt.iconRange&&this.opt.iconRange.length>count?(star=this.opt.iconRange[count],icon=this.opt.single?i==score?star.on||this.opt.starOn:star.off||this.opt.starOff:i<=score?star.on||this.opt.starOn:star.off||this.opt.starOff,i<=star.range&&$star.attr("src",this.opt.path+icon),i==star.range&&count++):(icon=this.opt.single?i==score?this.opt.starOn:this.opt.starOff:i<=score?this.opt.starOn:this.opt.starOff,$star.attr("src",this.opt.path+icon))},fixHint:function(){var $this=$(this),score=parseInt(this.score.val(),10),hint=this.opt.noRatedMsg;!isNaN(score)&&score>0&&(hint=score<=this.opt.hints.length&&null!==this.opt.hints[score-1]?this.opt.hints[score-1]:score),$this.data("readonly",!0).css("cursor","default").attr("title",hint),this.score.attr("readonly","readonly"),this.stars.attr("title",hint)},getScore:function(){var value,score=[];return $(this).each(function(){value=this.score.val(),score.push(value?parseFloat(value):void 0)}),score.length>1?score:score[0]},readOnly:function(isReadOnly){return this.each(function(){var $this=$(this);if($this.data("readonly")===isReadOnly)return this;this.cancel&&(isReadOnly?this.cancel.hide():this.cancel.show()),isReadOnly?($this.unbind(),$this.children("img").unbind(),methods.fixHint.call(this)):(methods.bindAction.call(this),methods.unfixHint.call(this)),$this.data("readonly",isReadOnly)})},reload:function(){return methods.set.call(this,{})},roundStar:function(score){var diff=(score-Math.floor(score)).toFixed(2);if(diff>this.opt.round.down){var icon=this.opt.starOn;diff<this.opt.round.up&&this.opt.halfShow?icon=this.opt.starHalf:diff<this.opt.round.full&&(icon=this.opt.starOff),this.stars.eq(Math.ceil(score)-1).attr("src",this.opt.path+icon)}},score:function(){return arguments.length?methods.setScore.apply(this,arguments):methods.getScore.call(this)},set:function(settings){return this.each(function(){var $this=$(this),actual=$this.data("settings"),clone=$this.clone().removeAttr("style").insertBefore($this);$this.remove(),clone.raty($.extend(actual,settings))}),$(this.selector)},setScore:function(score){return $(this).each(function(){if(!0===$(this).data("readonly"))return this;methods.initialize.call(this,score),methods.setTarget.call(this,score,!0)})},setTarget:function(value,isKeep){if(this.opt.target){var $target=$(this.opt.target);0==$target.length&&methods.error.call(this,"target selector invalid or missing!");var score=value;score=isKeep&&void 0!==score?"hint"==this.opt.targetType?null===score&&this.opt.cancel?this.opt.cancelHint:this.opt.hints[Math.ceil(score-1)]:this.opt.precision?parseFloat(score).toFixed(1):parseInt(score,10):this.opt.targetText,this.opt.targetFormat.indexOf("{score}")<0&&methods.error.call(this,'template "{score}" missing!'),null!==value&&(score=this.opt.targetFormat.toString().replace("{score}",score)),$target.is(":input")?$target.val(score):$target.html(score)}},showHalf:function(score){var diff=(score-Math.floor(score)).toFixed(1);diff>0&&diff<.6&&this.stars.eq(Math.ceil(score)-1).attr("src",this.opt.path+this.opt.starHalf)},initialize:function(score){score=score?methods.between(score,0,this.opt.number):0,methods.fill.call(this,score),score>0&&(this.opt.halfShow&&methods.roundStar.call(this,score),this.score.val(score))},unfixHint:function(){for(var i=0;i<this.opt.number;i++)this.stars.eq(i).attr("title",i<this.opt.hints.length&&null!==this.opt.hints[i]?this.opt.hints[i]:i);$(this).data("readonly",!1).css("cursor","pointer").removeAttr("title"),this.score.attr("readonly","readonly")}};$.fn.raty=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist!"):methods.init.apply(this,arguments)},$.fn.raty.defaults={cancel:!1,cancelHint:"cancel this rating!",cancelOff:"cancel-off.png",cancelOn:"cancel-on.png",cancelPlace:"left",click:void 0,half:!1,halfShow:!0,hints:["bad","poor","regular","good","gorgeous"],iconRange:void 0,mouseover:void 0,noRatedMsg:"not rated yet",number:5,path:"img/",precision:!1,round:{down:.25,full:.6,up:.76},readOnly:!1,score:void 0,scoreName:"score",single:!1,size:16,space:!0,starHalf:"star-half.png",starOff:"star-off.png",starOn:"star-on.png",target:void 0,targetFormat:"{score}",targetKeep:!1,targetText:"",targetType:"hint",width:void 0}}(jQuery),function(window,$,undefined){"use strict";var testName,transitionEndEvent,transitionDurProp,docElem=window.document.documentElement,Modernizr=window.Modernizr,capitalize=function(str){return str.charAt(0).toUpperCase()+str.slice(1)},prefixes="Moz Webkit O Ms".split(" "),getStyleProperty=function(propName){var prefixed,style=docElem.style;if("string"==typeof style[propName])return propName;propName=capitalize(propName);for(var i=0,len=prefixes.length;i<len;i++)if("string"==typeof style[prefixed=prefixes[i]+propName])return prefixed},transformProp=getStyleProperty("transform"),transitionProp=getStyleProperty("transitionProperty"),tests={csstransforms:function(){return!!transformProp},csstransforms3d:function(){var test=!!getStyleProperty("perspective");if(test&&"webkitPerspective"in docElem.style){var $style=$("<style>@media (transform-3d),(-webkit-transform-3d){#modernizr{height:3px}}</style>").appendTo("head"),$div=$('<div id="modernizr" />').appendTo("html");test=3===$div.height(),$div.remove(),$style.remove()}return test},csstransitions:function(){return!!transitionProp}};if(Modernizr)for(testName in tests)Modernizr.hasOwnProperty(testName)||Modernizr.addTest(testName,tests[testName]);else{Modernizr=window.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var result,classes=" ";for(testName in tests)result=tests[testName](),Modernizr[testName]=result,classes+=" "+(result?"":"no-")+testName;$("html").addClass(classes)}if(Modernizr.csstransforms){var transformFnNotations=Modernizr.csstransforms3d?{translate:function(position){return"translate3d("+position[0]+"px, "+position[1]+"px, 0) "},scale:function(scale){return"scale3d("+scale+", "+scale+", 1) "}}:{translate:function(position){return"translate("+position[0]+"px, "+position[1]+"px) "},scale:function(scale){return"scale("+scale+") "}},setIsoTransform=function(elem,name,value){var fnName,transformValue,data=$.data(elem,"isoTransform")||{},newData={},transformObj={};for(fnName in newData[name]=value,$.extend(data,newData),data)transformValue=data[fnName],transformObj[fnName]=transformFnNotations[fnName](transformValue);var valueFns=(transformObj.translate||"")+(transformObj.scale||"");$.data(elem,"isoTransform",data),elem.style[transformProp]=valueFns};$.cssNumber.scale=!0,$.cssHooks.scale={set:function(elem,value){setIsoTransform(elem,"scale",value)},get:function(elem,computed){var transform=$.data(elem,"isoTransform");return transform&&transform.scale?transform.scale:1}},$.fx.step.scale=function(fx){$.cssHooks.scale.set(fx.elem,fx.now+fx.unit)},$.cssNumber.translate=!0,$.cssHooks.translate={set:function(elem,value){setIsoTransform(elem,"translate",value)},get:function(elem,computed){var transform=$.data(elem,"isoTransform");return transform&&transform.translate?transform.translate:[0,0]}}}Modernizr.csstransitions&&(transitionEndEvent={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[transitionProp],transitionDurProp=getStyleProperty("transitionDuration"));var resizeTimeout,$event=$.event,dispatchMethod=$.event.handle?"handle":"dispatch";$event.special.smartresize={setup:function(){$(this).bind("resize",$event.special.smartresize.handler)},teardown:function(){$(this).unbind("resize",$event.special.smartresize.handler)},handler:function(event,execAsap){var context=this,args=arguments;event.type="smartresize",resizeTimeout&&clearTimeout(resizeTimeout),resizeTimeout=setTimeout(function(){$event[dispatchMethod].apply(context,args)},"execAsap"===execAsap?0:100)}},$.fn.smartresize=function(fn){return fn?this.bind("smartresize",fn):this.trigger("smartresize",["execAsap"])},$.Isotope=function(options,element,callback){this.element=$(element),this._create(options),this._init(callback)};var isoContainerStyles=["width","height"],$window=$(window);$.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!0,itemPositionDataEnabled:!1},$.Isotope.prototype={_create:function(options){this.options=$.extend({},$.Isotope.settings,options),this.styleQueue=[],this.elemCount=0;var elemStyle=this.element[0].style;this.originalStyle={};var containerStyles=isoContainerStyles.slice(0);for(var prop in this.options.containerStyle)containerStyles.push(prop);for(var i=0,len=containerStyles.length;i<len;i++)prop=containerStyles[i],this.originalStyle[prop]=elemStyle[prop]||"";this.element.css(this.options.containerStyle),this._updateAnimationEngine(),this._updateUsingTransforms();var originalOrderSorter={"original-order":function($elem,instance){return instance.elemCount++,instance.elemCount},random:function(){return Math.random()}};this.options.getSortData=$.extend(this.options.getSortData,originalOrderSorter),this.reloadItems(),this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var instance=this;setTimeout(function(){instance.element.addClass(instance.options.containerClass)},0),this.options.resizable&&$window.bind("smartresize.isotope",function(){instance.resize()}),this.element.delegate("."+this.options.hiddenClass,"click",function(){return!1})},_getAtoms:function($elems){var selector=this.options.itemSelector,$atoms=selector?$elems.filter(selector).add($elems.find(selector)):$elems,atomStyle={position:"absolute"};return $atoms=$atoms.filter(function(i,atom){return 1===atom.nodeType}),this.usingTransforms&&(atomStyle.left=0,atomStyle.top=0),$atoms.css(atomStyle).addClass(this.options.itemClass),this.updateSortData($atoms,!0),$atoms},_init:function(callback){this.$filteredAtoms=this._filter(this.$allAtoms),this._sort(),this.reLayout(callback)},option:function(opts){var updateOptionFn;if($.isPlainObject(opts))for(var optionName in this.options=$.extend(!0,this.options,opts),opts)this[updateOptionFn="_update"+capitalize(optionName)]&&this[updateOptionFn]()},_updateAnimationEngine:function(){var isUsingJQueryAnimation;switch(this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"")){case"css":case"none":isUsingJQueryAnimation=!1;break;case"jquery":isUsingJQueryAnimation=!0;break;default:isUsingJQueryAnimation=!Modernizr.csstransitions}this.isUsingJQueryAnimation=isUsingJQueryAnimation,this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var usingTransforms=this.usingTransforms=this.options.transformsEnabled&&Modernizr.csstransforms&&Modernizr.csstransitions&&!this.isUsingJQueryAnimation;usingTransforms||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale),this.getPositionStyles=usingTransforms?this._translate:this._positionAbs},_filter:function($atoms){var filter=""===this.options.filter?"*":this.options.filter;if(!filter)return $atoms;var hiddenClass=this.options.hiddenClass,hiddenSelector="."+hiddenClass,$hiddenAtoms=$atoms.filter(hiddenSelector),$atomsToShow=$hiddenAtoms;if("*"!==filter){$atomsToShow=$hiddenAtoms.filter(filter);var $atomsToHide=$atoms.not(hiddenSelector).not(filter).addClass(hiddenClass);this.styleQueue.push({$el:$atomsToHide,style:this.options.hiddenStyle})}return this.styleQueue.push({$el:$atomsToShow,style:this.options.visibleStyle}),$atomsToShow.removeClass(hiddenClass),$atoms.filter(filter)},updateSortData:function($atoms,isIncrementingElemCount){var $this,sortData,instance=this,getSortData=this.options.getSortData;$atoms.each(function(){for(var key in $this=$(this),sortData={},getSortData)sortData[key]=isIncrementingElemCount||"original-order"!==key?getSortData[key]($this,instance):$.data(this,"isotope-sort-data")[key];$.data(this,"isotope-sort-data",sortData)})},_sort:function(){var sortBy=this.options.sortBy,getSorter=this._getSorter,sortDir=this.options.sortAscending?1:-1;this.$filteredAtoms.sort(function(alpha,beta){var a=getSorter(alpha,sortBy),b=getSorter(beta,sortBy);return a===b&&"original-order"!==sortBy&&(a=getSorter(alpha,"original-order"),b=getSorter(beta,"original-order")),(a>b?1:a<b?-1:0)*sortDir})},_getSorter:function(elem,sortBy){return $.data(elem,"isotope-sort-data")[sortBy]},_translate:function(x,y){return{translate:[x,y]}},_positionAbs:function(x,y){return{left:x,top:y}},_pushPosition:function($elem,x,y){x=Math.round(x+this.offset.left),y=Math.round(y+this.offset.top);var position=this.getPositionStyles(x,y);this.styleQueue.push({$el:$elem,style:position}),this.options.itemPositionDataEnabled&&$elem.data("isotope-item-position",{x:x,y:y})},layout:function($elems,callback){var layoutMode=this.options.layoutMode;if(this["_"+layoutMode+"Layout"]($elems),this.options.resizesContainer){var containerStyle=this["_"+layoutMode+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:containerStyle})}this._processStyleQueue($elems,callback),this.isLaidOut=!0},_processStyleQueue:function($elems,callback){var objStyleFn,processor,triggerCallbackNow,callbackFn,styleFn=this.isLaidOut&&this.isUsingJQueryAnimation?"animate":"css",animOpts=this.options.animationOptions,onLayout=this.options.onLayout;if(processor=function(i,obj){obj.$el[styleFn](obj.style,animOpts)},this._isInserting&&this.isUsingJQueryAnimation)processor=function(i,obj){objStyleFn=obj.$el.hasClass("no-transition")?"css":styleFn,obj.$el[objStyleFn](obj.style,animOpts)};else if(callback||onLayout||animOpts.complete){var isCallbackTriggered=!1,callbacks=[callback,onLayout,animOpts.complete],instance=this;if(triggerCallbackNow=!0,callbackFn=function(){if(!isCallbackTriggered){for(var hollaback,i=0,len=callbacks.length;i<len;i++)"function"==typeof(hollaback=callbacks[i])&&hollaback.call(instance.element,$elems,instance);isCallbackTriggered=!0}},this.isUsingJQueryAnimation&&"animate"===styleFn)animOpts.complete=callbackFn,triggerCallbackNow=!1;else if(Modernizr.csstransitions){for(var styleObj,i=0,firstItem=this.styleQueue[0],testElem=firstItem&&firstItem.$el;!testElem||!testElem.length;){if(!(styleObj=this.styleQueue[i++]))return;testElem=styleObj.$el}parseFloat(getComputedStyle(testElem[0])[transitionDurProp])>0&&(processor=function(i,obj){obj.$el[styleFn](obj.style,animOpts).one(transitionEndEvent,callbackFn)},triggerCallbackNow=!1)}}$.each(this.styleQueue,processor),triggerCallbackNow&&callbackFn(),this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(callback){this["_"+this.options.layoutMode+"Reset"](),this.layout(this.$filteredAtoms,callback)},addItems:function($content,callback){var $newAtoms=this._getAtoms($content);this.$allAtoms=this.$allAtoms.add($newAtoms),callback&&callback($newAtoms)},insert:function($content,callback){this.element.append($content);var instance=this;this.addItems($content,function($newAtoms){var $newFilteredAtoms=instance._filter($newAtoms);instance._addHideAppended($newFilteredAtoms),instance._sort(),instance.reLayout(),instance._revealAppended($newFilteredAtoms,callback)})},appended:function($content,callback){var instance=this;this.addItems($content,function($newAtoms){instance._addHideAppended($newAtoms),instance.layout($newAtoms),instance._revealAppended($newAtoms,callback)})},_addHideAppended:function($newAtoms){this.$filteredAtoms=this.$filteredAtoms.add($newAtoms),$newAtoms.addClass("no-transition"),this._isInserting=!0,this.styleQueue.push({$el:$newAtoms,style:this.options.hiddenStyle})},_revealAppended:function($newAtoms,callback){var instance=this;setTimeout(function(){$newAtoms.removeClass("no-transition"),instance.styleQueue.push({$el:$newAtoms,style:instance.options.visibleStyle}),instance._isInserting=!1,instance._processStyleQueue($newAtoms,callback)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function($content,callback){this.$allAtoms=this.$allAtoms.not($content),this.$filteredAtoms=this.$filteredAtoms.not($content);var instance=this,removeContent=function(){$content.remove(),callback&&callback.call(instance.element)};$content.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:$content,style:this.options.hiddenStyle}),this._sort(),this.reLayout(removeContent)):removeContent()},shuffle:function(callback){this.updateSortData(this.$allAtoms),this.options.sortBy="random",this._sort(),this.reLayout(callback)},destroy:function(){var usingTransforms=this.usingTransforms,options=this.options;this.$allAtoms.removeClass(options.hiddenClass+" "+options.itemClass).each(function(){var style=this.style;style.position="",style.top="",style.left="",style.opacity="",usingTransforms&&(style[transformProp]="")});var elemStyle=this.element[0].style;for(var prop in this.originalStyle)elemStyle[prop]=this.originalStyle[prop];this.element.unbind(".isotope").undelegate("."+options.hiddenClass,"click").removeClass(options.containerClass).removeData("isotope"),$window.unbind(".isotope")},_getSegments:function(isRows){var segments,namespace=this.options.layoutMode,measure=isRows?"rowHeight":"columnWidth",size=isRows?"height":"width",segmentsName=isRows?"rows":"cols",containerSize=this.element[size](),segmentSize=this.options[namespace]&&this.options[namespace][measure]||this.$filteredAtoms["outer"+capitalize(size)](!0)||containerSize;segments=Math.floor(containerSize/segmentSize),segments=Math.max(segments,1),this[namespace][segmentsName]=segments,this[namespace][measure]=segmentSize},_checkIfSegmentsChanged:function(isRows){var namespace=this.options.layoutMode,segmentsName=isRows?"rows":"cols",prevSegments=this[namespace][segmentsName];return this._getSegments(isRows),this[namespace][segmentsName]!==prevSegments},_masonryReset:function(){this.masonry={},this._getSegments();var i=this.masonry.cols;for(this.masonry.colYs=[];i--;)this.masonry.colYs.push(0)},_masonryLayout:function($elems){var instance=this,props=instance.masonry;$elems.each(function(){var $this=$(this),colSpan=Math.ceil($this.outerWidth(!0)/props.columnWidth);if(1===(colSpan=Math.min(colSpan,props.cols)))instance._masonryPlaceBrick($this,props.colYs);else{var groupColY,i,groupCount=props.cols+1-colSpan,groupY=[];for(i=0;i<groupCount;i++)groupColY=props.colYs.slice(i,i+colSpan),groupY[i]=Math.max.apply(Math,groupColY);instance._masonryPlaceBrick($this,groupY)}})},_masonryPlaceBrick:function($brick,setY){for(var minimumY=Math.min.apply(Math,setY),shortCol=0,i=0,len=setY.length;i<len;i++)if(setY[i]===minimumY){shortCol=i;break}var x=this.masonry.columnWidth*shortCol,y=minimumY;this._pushPosition($brick,x,y);var setHeight=minimumY+$brick.outerHeight(!0),setSpan=this.masonry.cols+1-len;for(i=0;i<setSpan;i++)this.masonry.colYs[shortCol+i]=setHeight},_masonryGetContainerSize:function(){return{height:Math.max.apply(Math,this.masonry.colYs)}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function($elems){var instance=this,containerWidth=this.element.width(),props=this.fitRows;$elems.each(function(){var $this=$(this),atomW=$this.outerWidth(!0),atomH=$this.outerHeight(!0);0!==props.x&&atomW+props.x>containerWidth&&(props.x=0,props.y=props.height),instance._pushPosition($this,props.x,props.y),props.height=Math.max(props.y+atomH,props.height),props.x+=atomW})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return!0},_cellsByRowReset:function(){this.cellsByRow={index:0},this._getSegments(),this._getSegments(!0)},_cellsByRowLayout:function($elems){var instance=this,props=this.cellsByRow;$elems.each(function(){var $this=$(this),col=props.index%props.cols,row=Math.floor(props.index/props.cols),x=(col+.5)*props.columnWidth-$this.outerWidth(!0)/2,y=(row+.5)*props.rowHeight-$this.outerHeight(!0)/2;instance._pushPosition($this,x,y),props.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function($elems){var instance=this;$elems.each(function(i){var $this=$(this);instance._pushPosition($this,0,instance.straightDown.y),instance.straightDown.y+=$this.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return!0},_masonryHorizontalReset:function(){this.masonryHorizontal={},this._getSegments(!0);var i=this.masonryHorizontal.rows;for(this.masonryHorizontal.rowXs=[];i--;)this.masonryHorizontal.rowXs.push(0)},_masonryHorizontalLayout:function($elems){var instance=this,props=instance.masonryHorizontal;$elems.each(function(){var $this=$(this),rowSpan=Math.ceil($this.outerHeight(!0)/props.rowHeight);if(1===(rowSpan=Math.min(rowSpan,props.rows)))instance._masonryHorizontalPlaceBrick($this,props.rowXs);else{var groupRowX,i,groupCount=props.rows+1-rowSpan,groupX=[];for(i=0;i<groupCount;i++)groupRowX=props.rowXs.slice(i,i+rowSpan),groupX[i]=Math.max.apply(Math,groupRowX);instance._masonryHorizontalPlaceBrick($this,groupX)}})},_masonryHorizontalPlaceBrick:function($brick,setX){for(var minimumX=Math.min.apply(Math,setX),smallRow=0,i=0,len=setX.length;i<len;i++)if(setX[i]===minimumX){smallRow=i;break}var x=minimumX,y=this.masonryHorizontal.rowHeight*smallRow;this._pushPosition($brick,x,y);var setWidth=minimumX+$brick.outerWidth(!0),setSpan=this.masonryHorizontal.rows+1-len;for(i=0;i<setSpan;i++)this.masonryHorizontal.rowXs[smallRow+i]=setWidth},_masonryHorizontalGetContainerSize:function(){return{width:Math.max.apply(Math,this.masonryHorizontal.rowXs)}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function($elems){var instance=this,containerHeight=this.element.height(),props=this.fitColumns;$elems.each(function(){var $this=$(this),atomW=$this.outerWidth(!0),atomH=$this.outerHeight(!0);0!==props.y&&atomH+props.y>containerHeight&&(props.x=props.width,props.y=0),instance._pushPosition($this,props.x,props.y),props.width=Math.max(props.x+atomW,props.width),props.y+=atomH})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return!0},_cellsByColumnReset:function(){this.cellsByColumn={index:0},this._getSegments(),this._getSegments(!0)},_cellsByColumnLayout:function($elems){var instance=this,props=this.cellsByColumn;$elems.each(function(){var $this=$(this),col=Math.floor(props.index/props.rows),row=props.index%props.rows,x=(col+.5)*props.columnWidth-$this.outerWidth(!0)/2,y=(row+.5)*props.rowHeight-$this.outerHeight(!0)/2;instance._pushPosition($this,x,y),props.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function($elems){var instance=this;$elems.each(function(i){var $this=$(this);instance._pushPosition($this,instance.straightAcross.x,0),instance.straightAcross.x+=$this.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return!0}},$.fn.imagesLoaded=function(callback){var $this=this,$images=$this.find("img").add($this.filter("img")),len=$images.length,blank="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",loaded=[];function triggerCallback(){callback.call($this,$images)}return len||triggerCallback(),$images.bind("load.imagesLoaded error.imagesLoaded",function imgLoaded(event){var img=event.target;img.src!==blank&&-1===$.inArray(img,loaded)&&(loaded.push(img),--len<=0&&(setTimeout(triggerCallback),$images.unbind(".imagesLoaded",imgLoaded)))}).each(function(){var src=this.src;this.src=blank,this.src=src}),$this};var logError=function(message){window.console&&window.console.error(message)};$.fn.isotope=function(options,callback){if("string"==typeof options){var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$.data(this,"isotope");instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?instance[options].apply(instance,args):logError("no such method '"+options+"' for isotope instance"):logError("cannot call methods on isotope prior to initialization; attempted to call method '"+options+"'")})}else this.each(function(){var instance=$.data(this,"isotope");instance?(instance.option(options),instance._init(callback)):$.data(this,"isotope",new $.Isotope(options,this,callback))});return this}}(window,jQuery),$.support.cors=!0;var isotube={init:function(settings){isotube.vars={apiKey:"your_api_key",container:$("#isotube-result"),searchmode:"author",searchterm:"instantknut",infiniteScroll:!1},isotube.rtd={timeout:!1,indicatorImage:!1,indicatorRotation:!1,indicatorInterval:!1,pageCount:1,ytMaxResults:12},$.extend(isotube.vars,settings),!0===isotube.vars.infiniteScroll&&isotube.enableScroller(),isotube.observeElements()},setVar:function(settings){$.extend(isotube.vars,settings)},setRtd:function(settings){$.extend(isotube.rtd,settings)},findVideos:function(){var searchterm,$container=isotube.vars.container;$("#searchterm").length?0===(searchterm=$("#searchterm").val()).length&&(searchterm=isotube.vars.searchterm):searchterm=isotube.vars.searchterm;isotube.rtd.pageCount,isotube.rtd.ytMaxResults;isotube.showIndicator(),$.getJSON("https://www.googleapis.com/youtube/v3/search?q="+searchterm+"&key="+isotube.vars.apiKey+"&part=id,snippet&maxResults="+isotube.rtd.ytMaxResults+"&type=video&videoEmbeddable=true&callback=?",function(data){if(isotube.rtd.timeout&&(clearTimeout(isotube.rtd.timeout),isotube.rtd.timeout=!1),void 0!==data.items&&data.items.length>0){$("#block-youtube").show();var $elements="";$.each(data.items,function(itemId,item){$elements+=isotube.renderElement(item)}),$($container).append($elements)}isotube.hideIndicator()})},observeElements:function(){var $container=isotube.vars.container;$container.on("click",".element",function(e){$container.find(".tubethumb").show(),$container.find(".element").removeClass("video"),$container.find(".video-wrap").remove(),$(this).addClass("video"),$(this).find(".tubethumb").hide();var iframeHtml='<div class="video-wrap"><iframe src="https://www.youtube.com/embed/'+$(this).data("videoid")+'?enablejsapi=1&amp;color=white&amp;rel=0&amp;autoplay=1" allowfullscreen></iframe></div>';$(this).append(iframeHtml)})},renderElement:function(item){return'<div class="element" data-videoid="'+item.id.videoId+'"><img title="'+item.snippet.title+'" class="tubethumb" src="'+item.snippet.thumbnails.medium.url+'" /></div>'},showIndicator:function(){isotube.rtd.indicatorRotation||isotube.initIndicator(),isotube.rtd.indicatorInterval=setInterval(isotube.drawIndicator,10),$("#indicator").show()},hideIndicator:function(){$("#indicator").hide(),clearInterval(isotube.rtd.indicatorInterval)},initIndicator:function(){isotube.rtd.indicatorImage=new Image,isotube.rtd.indicatorRotation=0,isotube.rtd.indicatorImage.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABK1JREFUeNqMVt1ZGzkUvVfS4IW1l8GO82w6IBXE7mCpAFMB+Pt4Z6iApALcAe4AU0HoAJfg7BPYHinnXmmciX+y0YdmJHnQ0bk/R5cvh5cUyFPwRD4EChgEvGWMB36R3+JaiTkmD5gOs8yNb25uLlerFf1pM2yIGA82TEY7xow1oj4GBU6S6yywPNG4JwDH+XGv0Whs7ndN8n97mmPsLCSYgy7ImPQE/pFDyAF+7L0fgTNFUDBcLal90taD1doQ/T6NT9DnW8zkT+jJuQVYukG3hifCVk/L3JOxMBa8VVlSp9MhHKLaB+zpNo1fdgEpmByuMqUAV5viOQLwXNax9KBAFNEEpN1pUwnQmvl6aTza6zNjrCKaymeyOdYAMgfg18iG4T/qw+AC94zvpzDjcwqOXo3VGH26H0xMZ7jPxgT0R2zUi4BYt6bAfEbJvJFZKA4ODgZ5nhcJLE9mk35X21vWC/TXKmiwr2xszoQd/PQv3t/QCzY2twpqBpb5FKOp+hCgzWaTWq0W1Xx0ij5An9WC5VtiLMwvNBrVaSGMvQk5jHQVPN7sb0HzAtE+QJrNgrcUNEARieWCut0ugR0tl8sKcJ5Ahc3jRviPK8ZGTaaBwGKyT+gTiwM4a3Jrba6MbeVXo5F4kp9shn29ndUYC9vLirGDXzRhrYhD8DME5Hkg22df5rDYS/RXmVIsaP/Q/SXs600YnifTjbeSWliEdTYb3QyTqYfdDKTL4B1KS6tVqf6SgGq3P9BvZGpvNIrPCgVKZlGlCDQDxJiCjVppCab05DJHzb+b1Gm36X80cVjLuzozexs0f6IgRkA5XRhzIixRL1+IzhwdHVHrn1Y9oXe1i10aKT6bGGhg1CKK+cT0zCGCs0oXTIogybJMw/779//o48duMvnO9rzLn+Kz8wgS5Shqo4njpCoOQA5Ajb8adHh4SMvVghaLhYb/HsBip88krNVISSEigOlhjmi0LziNhr6wOsgO9C1339vbGznnNAU2AM9Svk235cqKieKGkldAf7DGvTrjnjJnzyQoMu0ZTuZgUqvmlYR+f39XIE4uqCX1E/rDZpCYmKwOOmivAfYK9KF1AM7EdG4uAMLAOjmQideQXOJQkyUisqYiFRhtSFbxCxj8do0T30dmTvLhC+an0MZZVBHX09tBTG4qFigZEJEChjTIEwtRik81Qa7uOQU0IrYAe7FRjqYw6SlYjgAyN1GmHsFIGPfVnxzFuFITKEkfYK+oWZ5qKlIkcZ7UE92oXBmeIgIxtAO5UtSHqo9uiLW+sme5ejSIRASeAFR4LYy8MMzL1aq3EYWzJF28BgMEzGYpBkrMKelgl+P6uTcVY8NjLYyYPwMTCcufSaouH6al9xNJcjC82vDb9uVZKbrWIumNO+waVsu1TCC+Wxcg6xaSpsZSYM2wLO9/U8qZWH+wztQnsfAxV/E3MIKZVf1FsmJVV8mamhEmxZ0X7sSsABsGv1tZJGejmptU7FBUDYzPAXQBwFEEl+9+stFEroJEci2ELwIMmZuWoSTE9DYYcWVCjlJrZWMpeBhlAEqBiulPE84S3ixU5gSTwGGOdyEVNJXxA8nPevshwABHktBS1YoQ+QAAAABJRU5ErkJggg=="},drawIndicator:function(){try{var ctx=document.getElementById("indicator").getContext("2d");ctx.globalCompositeOperation="destination-over",ctx.save(),ctx.clearRect(0,0,27,27),ctx.translate(13.5,13.5),isotube.rtd.indicatorRotation+=1,ctx.rotate(isotube.rtd.indicatorRotation*Math.PI/64),ctx.translate(-13.5,-13.5),ctx.drawImage(isotube.rtd.indicatorImage,0,0),ctx.restore()}catch(err){console.log(err)}},enableScroller:function(){$(window).scroll(function(){$(window).scrollTop()===$(document).height()-$(window).height()&&(isotube.rtd.pageCount++,isotube.findVideos())})}};function debug(log_txt){void 0!==window.console&&window.console.log(log_txt)}function debugObj(log_txt){void 0!==window.console&&window.console.log(JSON.parse(log_txt))}function isTrue(value){switch("string"==typeof value&&(value=value.toLowerCase()),value){case!0:case"true":case 1:case"1":case"y":return!0;default:return!1}}(function(){var $,Lightbox,LightboxOptions;$=jQuery,LightboxOptions=function(){function LightboxOptions(){this.fadeDuration=100,this.fitImagesInViewport=!0,this.resizeDuration=100,this.showImageNumberLabel=!0,this.wrapAround=!1}return LightboxOptions.prototype.albumLabel=function(curImageNum,albumSize){return"Image "+curImageNum+" of "+albumSize},LightboxOptions}(),Lightbox=function(){function Lightbox(options){this.options=options,this.album=[],this.currentImageIndex=void 0,this.init()}return Lightbox.prototype.init=function(){return this.enable(),this.build()},Lightbox.prototype.enable=function(){var _this=this;return $("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(e){return _this.start($(e.currentTarget)),!1})},Lightbox.prototype.build=function(){var _this=this;return $("<div id='lightboxOverlay' class='lightboxOverlay'></div><div id='lightbox' class='lightbox'><div class='lb-outerContainer'><div class='lb-container'><img class='lb-image' src='' /><div class='lb-nav'><a class='lb-prev' href='' ></a><a class='lb-next' href='' ></a></div><div class='lb-loader'><a class='lb-cancel'></a></div></div></div><div class='lb-dataContainer'><div class='lb-data'><div class='lb-details'><span class='lb-caption'></span><span class='lb-number'></span></div><div class='lb-closeContainer'><a class='lb-close'></a></div></div></div></div>").appendTo($("body")),this.$lightbox=$("#lightbox"),this.$overlay=$("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.containerTopPadding=parseInt(this.$container.css("padding-top"),10),this.containerRightPadding=parseInt(this.$container.css("padding-right"),10),this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10),this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10),this.$overlay.hide().on("click",function(){return _this.end(),!1}),this.$lightbox.hide().on("click",function(e){return"lightbox"===$(e.target).attr("id")&&_this.end(),!1}),this.$outerContainer.on("click",function(e){return"lightbox"===$(e.target).attr("id")&&_this.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return 0===_this.currentImageIndex?_this.changeImage(_this.album.length-1):_this.changeImage(_this.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return _this.currentImageIndex===_this.album.length-1?_this.changeImage(0):_this.changeImage(_this.currentImageIndex+1),!1}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return _this.end(),!1})},Lightbox.prototype.start=function($link){var $window,a,dataLightboxValue,i,imageNumber,left,top,_i,_j,_len,_len1,_ref,_ref1;if($(window).on("resize",this.sizeOverlay),$("select, object, embed").css({visibility:"hidden"}),this.$overlay.width($(document).width()).height($(document).height()).show(),this.album=[],imageNumber=0,dataLightboxValue=$link.attr("data-lightbox"))for(i=_i=0,_len=(_ref=$($link.prop("tagName")+'[data-lightbox="'+dataLightboxValue+'"]')).length;_i<_len;i=++_i)a=_ref[i],this.album.push({link:$(a).attr("href"),title:$(a).attr("title")}),$(a).attr("href")===$link.attr("href")&&(imageNumber=i);else if("lightbox"===$link.attr("rel"))this.album.push({link:$link.attr("href"),title:$link.attr("title")});else for(i=_j=0,_len1=(_ref1=$($link.prop("tagName")+'[rel="'+$link.attr("rel")+'"]')).length;_j<_len1;i=++_j)a=_ref1[i],this.album.push({link:$(a).attr("href"),title:$(a).attr("title")}),$(a).attr("href")===$link.attr("href")&&(imageNumber=i);top=($window=$(window)).scrollTop()+$window.height()/10,left=$window.scrollLeft(),this.$lightbox.css({top:top+"px",left:left+"px"}).show(),this.changeImage(imageNumber)},Lightbox.prototype.changeImage=function(imageNumber){var $image,preloader,_this=this;this.disableKeyboardNav(),$image=this.$lightbox.find(".lb-image"),this.sizeOverlay(),this.$overlay.show(),$(".lb-loader").show(),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating"),(preloader=new Image).onload=function(){var imageHeight,imageWidth,maxImageHeight,maxImageWidth,windowHeight,windowWidth;return $image.attr("src",_this.album[imageNumber].link),$(preloader),$image.width(preloader.width),$image.height(preloader.height),_this.options.fitImagesInViewport&&(windowWidth=$(window).width(),windowHeight=$(window).height(),maxImageWidth=windowWidth-_this.containerLeftPadding-_this.containerRightPadding-20,maxImageHeight=windowHeight-_this.containerTopPadding-_this.containerBottomPadding-110,(preloader.width>maxImageWidth||preloader.height>maxImageHeight)&&(preloader.width/maxImageWidth>preloader.height/maxImageHeight?(imageWidth=maxImageWidth,imageHeight=parseInt(preloader.height/(preloader.width/imageWidth),10),$image.width(imageWidth),$image.height(imageHeight)):(imageHeight=maxImageHeight,imageWidth=parseInt(preloader.width/(preloader.height/imageHeight),10),$image.width(imageWidth),$image.height(imageHeight)))),_this.sizeContainer($image.width(),$image.height())},preloader.src=this.album[imageNumber].link,this.currentImageIndex=imageNumber},Lightbox.prototype.sizeOverlay=function(){return $("#lightboxOverlay").width($(document).width()).height($(document).height())},Lightbox.prototype.sizeContainer=function(imageWidth,imageHeight){var newHeight,newWidth,_this=this;this.$outerContainer.outerWidth(),this.$outerContainer.outerHeight(),newWidth=imageWidth+this.containerLeftPadding+this.containerRightPadding,newHeight=imageHeight+this.containerTopPadding+this.containerBottomPadding,this.$outerContainer.animate({width:newWidth,height:newHeight},this.options.resizeDuration,"swing"),setTimeout(function(){_this.$lightbox.find(".lb-dataContainer").width(newWidth),_this.$lightbox.find(".lb-prevLink").height(newHeight),_this.$lightbox.find(".lb-nextLink").height(newHeight),_this.showImage()},this.options.resizeDuration)},Lightbox.prototype.showImage=function(){this.$lightbox.find(".lb-loader").hide(),this.$lightbox.find(".lb-image").show(),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},Lightbox.prototype.updateNav=function(){this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?this.$lightbox.find(".lb-prev, .lb-next").show():(this.currentImageIndex>0&&this.$lightbox.find(".lb-prev").show(),this.currentImageIndex<this.album.length-1&&this.$lightbox.find(".lb-next").show()))},Lightbox.prototype.updateDetails=function(){var _this=this;void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).show(),this.album.length>1&&this.options.showImageNumberLabel?this.$lightbox.find(".lb-number").text(this.options.albumLabel(this.currentImageIndex+1,this.album.length)).show():this.$lightbox.find(".lb-number").hide(),this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.resizeDuration,function(){return _this.sizeOverlay()})},Lightbox.prototype.preloadNeighboringImages=function(){this.album.length>this.currentImageIndex+1&&((new Image).src=this.album[this.currentImageIndex+1].link),this.currentImageIndex>0&&((new Image).src=this.album[this.currentImageIndex-1].link)},Lightbox.prototype.enableKeyboardNav=function(){$(document).on("keyup.keyboard",$.proxy(this.keyboardAction,this))},Lightbox.prototype.disableKeyboardNav=function(){$(document).off(".keyboard")},Lightbox.prototype.keyboardAction=function(event){var key,keycode;keycode=event.keyCode,key=String.fromCharCode(keycode).toLowerCase(),27===keycode||key.match(/x|o|c/)?this.end():"p"===key||37===keycode?0!==this.currentImageIndex&&this.changeImage(this.currentImageIndex-1):"n"!==key&&39!==keycode||this.currentImageIndex!==this.album.length-1&&this.changeImage(this.currentImageIndex+1)},Lightbox.prototype.end=function(){return this.disableKeyboardNav(),$(window).off("resize",this.sizeOverlay),this.$lightbox.hide(),this.$overlay.hide(),$("select, object, embed").css({visibility:"visible"})},Lightbox}(),$(function(){var options;return options=new LightboxOptions,new Lightbox(options)})}).call(this);var modular={init:function(settings){this.config={domain:null,webroot:null,format:null,currency:"eur",baseUrl:null,is_anonymous:0,registeredKeys:[8,9,13,27,37,38,39,40,46,67,68,70,86,88,90,188,190]},this.rtd={timeout:!1,searchOrder:"newest",searchDirection:"asc",kbdShortcutsEnabled:0,popoverEnabled:0,spaceguidesEnabled:0,panelselectorEnabled:0,lockEnabled:0,activeRackId:null,isOwnedByUser:!1,rackIsEditable:!1,request:!1,$draggable:null,$draggableHandle:null,$hitList:null,collisionState:null,rack:null,kbd:{},parkedCol:0,modulesOutOfBounds:[],tops:[],mids:[],ctx:{},moduleInFocus:[],moduleMapObj:{},thing:"Module",isTouchDevice:!1,ytPlayers:[],searchCtrl:"racks",snapTolerance:0},$.extend(this.config,settings),modular.buildBaseUrl(),modular.checkTouchDevice(),modular.initAddObj(),modular.checkCookieConsent(),modular.observePostlinks(),modular.observeAnonymousLogout()},checkTouchDevice:function(){modular.rtd.isTouchDevice="ontouchstart"in document.documentElement},initAddObj:function(){var addObj=$("#addObj");if(addObj.length){debug("init add object");var objString=addObj.data("controller"),propString=addObj.data("action"),obj=window[objString];"function"==typeof obj[propString]&&obj[propString]()}else debug("no add object")},buildBaseUrl:function(){modular.config.baseUrl=modular.config.domain+modular.config.webroot+modular.config.format.id+"/"},showIndicator:function($elmt,style){void 0===$elmt&&($elmt=$("body")),void 0===style&&(style=""),$elmt.append($("<canvas>").attr({class:"indicator",style:style}))},hideIndicator:function(elmt){elmt?$(elmt.find(".indicator")).remove():$(".indicator").remove()},alert:function(data){var headText="Something does not work as expected",msg="Unknown error from the abyss of shadows";"object"==typeof data?(data.statusText||data.status)&&(msg=data.statusText,403==data.status&&(headText="Error 403",msg="This could mean that you are logged out because you have been idle for too long. Try to log in again.")):"string"==typeof data&&"Forbidden"===(msg=data)&&(headText="Log In required",msg="You have to log in to use this function."),$("#alert-modal-header-text").html(headText),$("#modal-body-text").html(msg),$("#myModal").modal("show")},flatAlert:function(msg,alertClass){void 0===alertClass&&(alertClass="alert-error"),$("#navbar-top").after('<div class="alert '+alertClass+'">'+msg+'<button class="close" data-dismiss="alert">×</button></div>')},moveModule:function(elmt,modulesRackId,row,col){var te=elmt.data("te");$.ajax({url:modular.config.baseUrl+"modules_racks/move.json",cache:!1,dataType:"json",data:{modules_rack_id:modulesRackId,row:row,col:col},context:elmt,beforeSend:function(){modular.showIndicator(elmt,"position: absolute; top: 50%; margin-top: -19px; left: "+Math.round(te/2*modular.rtd.gridColWidth)+"px;")},success:function(data){modular.hideIndicator(),!0===data.response.success?(modular.updateModuleMap(elmt,{row:row,col:col}),modular.buildHtmlMap(),modular.rtd.moduleInFocus.currentCol=col,modular.rtd.moduleInFocus.currentRow=row,modular.updateTotalsIfModuleWasParked(),modular.hideWorkbench(modulesRackId)):debug("error")},error:function(data){modular.hideIndicator(),modular.alert(data)}})},updateTotalsIfModuleWasParked:function(){modular.updateTotals(modular.rtd.activeRackId)},fuzzyswapModule:function(elmt,modulesRackId1,modulesRackId2,targetCol){var te=elmt.data("te");$.ajax({url:modular.config.baseUrl+"modules_racks/fuzzyswap.json",cache:!1,dataType:"json",data:{modules_rack_id1:modulesRackId1,modules_rack_id2:modulesRackId2,targetCol:targetCol},context:elmt,beforeSend:function(){modular.showIndicator(elmt,"position: absolute; top: 50%; margin-top: -19px; left: "+Math.round(te/2*modular.rtd.gridColWidth)+"px;")},success:function(data){modular.hideIndicator(),!0===data.response.success?(modular.rearrangeSwappedModules(data),modular.rtd.moduleInFocus.currentCol=parseInt(data.response.result[modulesRackId1].ModulesRack.col),modular.rtd.moduleInFocus.currentRow=parseInt(data.response.result[modulesRackId1].ModulesRack.row),modular.updateTotalsIfModuleWasParked(),modular.hideWorkbench(modulesRackId1)):debug("error")},error:function(data){modular.hideIndicator(),modular.alert(data)}})},rearrangeSwappedModules:function(data){$.each(data.response.result,function(index,moduleData){$("#mod"+index).css({top:modular.moduleRowToTop(moduleData.ModulesRack.row)+"px",left:modular.moduleColToLeft(moduleData.ModulesRack.col)+"px"}),$("#mod"+index).find(".handle").removeClass("swap"),modular.deleteModuleMapKey(index)}),$.each(data.response.result,function(index,moduleData){modular.addModuleMapKey({row:moduleData.ModulesRack.row,col:moduleData.ModulesRack.col},index)}),modular.buildHtmlMap(),modular.clearCanvasGuides()},initRack:function(){modular.calculateTopsAndMids(),modular.calculateSnapTolerance(),$.each(modular.rtd.rack.Module,function(index,moduleData){var $module=modular.renderModule(moduleData);$("#modules").append($module),!0===modular.rtd.isOwnedByUser&&modular.enableDraggable($($module))}),modular.catEvade()},catEvade:function(){var animationEvent=function(){var t,el=document.createElement("fakeelement"),animations={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in animations)if(void 0!==el.style[t])return animations[t]}(),startEvent="mouseenter";modular.rtd.isTouchDevice&&(startEvent="touchstart"),$("#wrap-cat").on(startEvent,function(){var cat=$(this);cat.addClass("evade"),cat.one(animationEvent,function(event){cat.removeClass("evade"),cat.css("left","-200px"),cat.css("visibility","hidden");setTimeout(function(){cat.css("visibility","visible"),cat.css("left","0px")},5e3)})})},initGuidesCanvas:function(){var canvas=document.getElementById("rack-guides");canvas.width=modular.rtd.gridColWidth*modular.rtd.rack.Rack.te*2,canvas.height=2*$("#restraint").height(),canvas.style.width=canvas.width/2+"px",canvas.style.height=canvas.height/2+"px",modular.rtd.ctx=canvas.getContext("2d"),modular.rtd.ctx.scale(2,2),modular.rtd.ctx.font="16px Georgia, Helvetica, sans-serif",modular.rtd.ctx.textAlign="center"},renderModule:function(module){var li=[];1==modular.config.format.displayPowerSpecs&&(1==module.is_passive?li.push("<li>Module does not draw current</li>"):(null!==module.current_plus?li.push("<li>"+module.current_plus+" mA +"+modular.config.format.volt+"V</li>"):li.push("<li class='muted'><em>?</em> mA +"+modular.config.format.volt+"V</li>"),null!==module.current_min?li.push("<li>"+module.current_min+" mA -"+modular.config.format.volt+"V</li>"):li.push("<li class='muted'><em>?</em> mA -"+modular.config.format.volt+"V</li>"),1==modular.config.format.has5V&&(null!==module.current5v?li.push("<li>"+module.current5v+" mA 5V</li>"):li.push("<li class='muted'><em>?</em> mA 5V</li>")))),null!==module.depth&&0!==module.depth.length&&0!==module.depth&&li.push("<li>"+module.depth+" mm Depth</li>"),"eur"===modular.config.currency?null!==module.price_eur&&0!==module.price_eur.length&&0!==module.price_eur&&li.push("<li>€"+module.price_eur+"</li>"):null!==module.price_usd&&0!==module.price_usd.length&&0!==module.price_usd&&li.push("<li>$"+module.price_usd+"</li>"),module.te&&li.push("<li>"+module.te+" HP</li>");var ul="<ul>"+li.join("")+"</ul>",description=null!==module.description?"<p class='pop'><em>"+module.description+"</em></p>":"",resizeCommand="r",classModule="module";1==module.is_1u&&(resizeCommand="1u",classModule="module module-1u");var imgSrc=modular.getPanelImg(module.ModulesRack,resizeCommand),imgSrcSet=modular.getPanelImg(module.ModulesRack,resizeCommand+"@2x"),$panelSelector="";if(!0===modular.rtd.isOwnedByUser){var uniqueVersions=_.uniqBy(module.Version,"imagehash"),panelVersionKey=_.findKey(uniqueVersions,{imageid:module.ModulesRack.version_id}),panelImgVersionPos=void 0===panelVersionKey?0:parseInt(panelVersionKey)+1,panelImgVersionQty=uniqueVersions.length,$panelImgIndicator=modular.renderPanelImgIndicator(panelImgVersionPos,panelImgVersionQty);panelImgVersionQty>0&&($panelSelector=$("<div>").attr({class:"panel-selector btn-group"}).append($("<a>").attr({"data-direction":"prev",href:"#",class:"btn btn-mini btn-primary",title:"newer panel version"}).html("<i class='icon-chevron-left icon-white'></i>")).append($("<a>").attr({"data-direction":"next",href:"#",class:"btn btn-mini btn-primary btn-next",title:"older panel version"}).html("<i class='icon-chevron-right icon-white'></i>")).append($panelImgIndicator))}var $module=$("<div>").attr({class:classModule,id:"mod"+module.ModulesRack.id,"data-te":module.te,"data-row":module.ModulesRack.row,"data-col":module.ModulesRack.col,"data-orientation":module.ModulesRack.orientation,"data-modules_rack_id":module.ModulesRack.id,"data-module-id":module.id,"data-original-title":module.Vendor.name+" <strong>"+module.name+"</strong>","data-content":description+ul}).css({top:modular.moduleRowToTop(module.ModulesRack.row)+"px",left:modular.moduleColToLeft(module.ModulesRack.col)+"px"}).append($("<div>").attr({class:"handle"}).css({width:module.te*modular.rtd.gridColWidth+"px"}).append($("<img>").attr({src:imgSrc}).attr({srcset:imgSrcSet+" 2x"}).css({transform:"rotate("+module.ModulesRack.orientation+"deg)"})).append($panelSelector)).append($("<div>").attr({class:"btn-group module-edit-btns"}).append($("<a>").attr({href:modular.config.baseUrl+module.slug,class:"btn btn-primary lnk-show-module"}).html("<i class='icon-info-sign icon-white'></i>")).append($("<a>").attr("class","btn btn-zoom lnk-zoom-module").html("<i class='icon-search icon-white'></i>")).append($("<a>").attr("class","btn btn-warning lnk-rotate-module").html("<i class='icon-repeat icon-white'></i>")).append($("<a>").attr("class","btn btn-danger lnk-delete-module").html("<i class='icon-trash icon-white'></i>")));return modular.initPopover($module),0==module.ModulesRack.row&&modular.rtd.modulesOutOfBounds.push(parseInt(module.ModulesRack.id)),$module},moduleRowToTop:function(row){return row>0?modular.config.tops[row-1]:$("#rack-wrapper").height()},moduleColToLeft:function(col){var leftPosInPx=0;return col>0?leftPosInPx=Math.floor((col-1)*modular.rtd.gridColWidth):(modular.showWorkbench(),leftPosInPx=Math.floor(modular.rtd.parkedCol*modular.rtd.gridColWidth),modular.rtd.parkedCol+=2),leftPosInPx},observeRotateBtn:function(){$("#rack").on("click",".lnk-rotate-module",function(e){e.preventDefault();var $module=$(this).closest(".module"),modulesRackId=$module.data("modules_rack_id"),orientation=(parseInt($module.data("orientation"))+180)%360;$module.data("orientation",orientation),modular.hidePopover($(this)),modular.rotateModule($module,modulesRackId,orientation)})},rotateModule:function(elmt,modulesRackId,orientation){var te=elmt.data("te");$.ajax({url:modular.config.baseUrl+"modules_racks/rotate.json",cache:!1,dataType:"json",data:{modules_rack_id:modulesRackId,orientation:orientation},context:elmt,beforeSend:function(){modular.showIndicator(elmt,"position: absolute; top: 50%; margin-top: -19px; left: "+Math.round(te/2*modular.rtd.gridColWidth)+"px;")},success:function(data){modular.hideIndicator(),!0===data.response.success?elmt.find("img").css({"transform-origin":"50% 50%",transform:"rotate("+orientation+"deg)"}):debug("error")},error:function(data){modular.hideIndicator(),modular.alert(data)}})},calculateTopsAndMids:function(){var tops=[0],mids=[],top=0,mid=0;for(row=1;row<=modular.rtd.rack.Rack.rows;row++){modular.rtd.rack.Rack.rows1u.indexOf(row.toString())>-1?"d"==modular.config.format.id?(mid=top+82.5,top+=165+modular.rtd.gridRowBottomMargin):"u"==modular.config.format.id?(mid=top+modular.rtd.gridRowHeight/2/2,top+=modular.rtd.gridRowHeight/2+modular.rtd.gridRowBottomMargin):(mid=top+modular.rtd.gridRowHeight/3/2,top+=modular.rtd.gridRowHeight/3+modular.rtd.gridRowBottomMargin):(mid=top+modular.rtd.gridRowHeight/2,top+=modular.rtd.gridRowHeight+modular.rtd.gridRowBottomMargin),tops.push(top),mids.push(mid)}modular.config.tops=tops,modular.config.mids=mids},calculateSnapTolerance:function(){modular.rtd.snapTolerance=modular.rtd.gridColWidth,-1!=$.inArray(modular.config.format.id,["u","d"])&&(modular.rtd.snapTolerance=modular.rtd.snapTolerance/2)},showWorkbench:function(){$("#rack-wrapper").hasClass("workbench")||$("#rack-wrapper").addClass("workbench")},hideWorkbench:function(modulesRackId){var index=modular.rtd.modulesOutOfBounds.indexOf(modulesRackId);index>-1&&modular.rtd.modulesOutOfBounds.splice(index,1),modular.rtd.modulesOutOfBounds.length<1&&($("#rack-wrapper").removeClass("workbench"),modular.rtd.parkedCol=0)},enableDraggable:function($module){$module.draggable({snap:".cell",snapMode:"inner",revertDuration:200,snapTolerance:modular.rtd.snapTolerance,cancel:".btn-group",stack:".module",handle:".handle",start:function(){modular.hidePopover($(this)),$(this).draggable("option","revert",!1)}})},enableDroppable:function(){$(".cell").droppable({addClasses:!1,greedy:!0,over:function(event,ui){var module=[];module.modulesRackId=modular.rtd.activeModuleRackId,module.te=ui.draggable.data("te"),module.currentRow=$(this).parent().data("row"),module.currentCol=$(this).data("col"),modular.calculateSpaceguides(module)},out:function(event,ui){modular.runCollisionDetection($(ui.draggable))},drop:function(){modular.moduleDrop($(this),$(this).parent().data("row"),$(this).data("col"))}}),$("#content-wrapper").droppable({addClasses:!1,drop:function(event,ui){modular.rtd.$draggable=$(ui.draggable),$("#modules").find(".handle").removeClass("collision swap"),modular.moveModuleOutOfBounds()}})},calculateSpaceguides:function(module){if(1==modular.rtd.spaceguidesEnabled){var gcw=modular.rtd.gridColWidth,space=modular.calcSurroundingSpace(module),leftSpace=space.left,rightSpace=space.right,guideXLeft=module.currentCol*gcw-leftSpace*gcw-gcw,guideXRight=module.currentCol*gcw+module.te*gcw-gcw,guideY=modular.config.mids[module.currentRow-1];modular.clearCanvasGuides();var Line=function(x1,y1,x2,y2){this.x1=x1,this.y1=y1,this.x2=x2,this.y2=y2};if(Line.prototype.drawWithArrowheads=function(ctx){ctx.strokeStyle="#fff",ctx.fillStyle="#fff",ctx.lineWidth=1,ctx.beginPath(),ctx.moveTo(this.x1,this.y1),ctx.lineTo(this.x2,this.y2),ctx.stroke();var startRadians=Math.atan((this.y2-this.y1)/(this.x2-this.x1));startRadians+=(this.x2>this.x1?-90:90)*Math.PI/180,this.drawArrowhead(ctx,this.x1,this.y1,startRadians);var endRadians=Math.atan((this.y2-this.y1)/(this.x2-this.x1));endRadians+=(this.x2>this.x1?90:-90)*Math.PI/180,this.drawArrowhead(ctx,this.x2,this.y2,endRadians)},Line.prototype.drawArrowhead=function(ctx,x,y,radians){ctx.save(),ctx.beginPath(),ctx.translate(x,y),ctx.rotate(radians),ctx.moveTo(0,-1),ctx.lineTo(4,10),ctx.lineTo(-4,10),ctx.closePath(),ctx.restore(),ctx.fill()},leftSpace>1)new Line(guideXLeft,guideY,module.currentCol*gcw-gcw,guideY).drawWithArrowheads(modular.rtd.ctx);if(rightSpace>1)new Line(guideXRight,guideY,guideXRight+rightSpace*gcw,guideY).drawWithArrowheads(modular.rtd.ctx);leftSpace>0&&modular.rtd.ctx.fillText(leftSpace,guideXLeft+leftSpace*gcw/2,guideY-8),rightSpace>0&&modular.rtd.ctx.fillText(rightSpace,guideXRight+rightSpace*gcw/2,guideY-8)}},calcSurroundingSpace:function(module){var leftSpace=module.currentCol-1,rightSpace=modular.rtd.rack.Rack.te-(module.currentCol+module.te)+1;return void 0!==modular.rtd.moduleMapObj[module.currentRow]&&$.each(modular.rtd.moduleMapObj[module.currentRow],function(col,modulesRackId){if(col=parseInt(col),module.modulesRackId!=modulesRackId)if(module.currentCol>col){var leftModuleHP=parseInt($("#mod"+modulesRackId).data("te"),10);leftSpace=module.currentCol-(col+leftModuleHP)}else{var tmpRightSpace=col-(module.currentCol+module.te);tmpRightSpace<rightSpace&&(rightSpace=tmpRightSpace)}}),{left:leftSpace,right:rightSpace}},clearCanvasGuides:function(){void 0!==modular.rtd.ctx.canvas&&modular.rtd.ctx.clearRect(0,0,modular.rtd.ctx.canvas.width,modular.rtd.ctx.canvas.height)},moveModuleOutOfBounds:function(){var modulesRackId=modular.rtd.$draggable.data("modules_rack_id"),te=modular.rtd.$draggable.data("te"),elmt=modular.rtd.$draggable;$.ajax({url:modular.config.baseUrl+"modules_racks/move_out_of_bounds.json",cache:!1,dataType:"json",data:{modules_rack_id:modulesRackId},context:elmt,beforeSend:function(){modular.showIndicator(elmt,"position: absolute; top: 50%; margin-top: -19px; left: "+Math.round(te/2*modular.rtd.gridColWidth)+"px;")},success:function(data){(modular.hideIndicator(),!0===data.response.success)?(modular.deleteModuleMapKey(modulesRackId),modular.buildHtmlMap(),modular.updateTotals(modular.rtd.activeRackId),-1===modular.rtd.modulesOutOfBounds.indexOf(modulesRackId)&&(modular.rtd.modulesOutOfBounds.push(modulesRackId),modular.showWorkbench()),modular.clearCanvasGuides()):debug("error")},error:function(data){modular.hideIndicator(),modular.alert(data)}})},moduleDrop:function($elmt,row,col){var modulesRackId1,modulesRackId2;if("fuzzyswap"===modular.rtd.collisionState)modulesRackId1=modular.rtd.$draggable.data("modules_rack_id"),modulesRackId2=modular.rtd.$hitList.closest(".module").data("modules_rack_id"),modular.fuzzyswapModule(modular.rtd.$draggable,modulesRackId1,modulesRackId2,col);else if("collide"===modular.rtd.collisionState)$("#modules").find(".handle").removeClass("collision swap"),modular.resetModulePosition();else if(modular.rtd.$draggable){var modulesRackId=modular.rtd.$draggable.data("modules_rack_id");modular.moveModule(modular.rtd.$draggable,modulesRackId,row,col)}else debug("$draggable is not defined")},runCollisionDetection:function($draggableElmt){$("#modules").find(".handle").removeClass("collision swap"),modular.rtd.$draggable=$draggableElmt,modular.rtd.$draggableHandle=modular.rtd.$draggable.find(".handle"),modular.rtd.$hitList=modular.rtd.$draggableHandle.collision($(".module").not(modular.rtd.$draggable).find(".handle")),modular.rtd.collisionState=modular.checkCollision(modular.rtd.$draggable,modular.rtd.$draggableHandle,modular.rtd.$hitList),"fuzzyswap"===modular.rtd.collisionState?modular.rtd.$hitList.addClass("swap"):"collide"===modular.rtd.collisionState&&modular.rtd.$hitList.addClass("collision")},checkCollision:function($draggable,$draggableHandle,$hitlist){return $hitlist.length>0?1===$hitlist.length&&$($hitlist).width()>=$draggableHandle.width()?"fuzzyswap":"collide":"ok"},observeInfoBtn:function(){$("#rack").on("mouseenter",".handle",function(){modular.showModuleButtons($(this))})},observeDeleteBtn:function(){$("#rack").on("click",".lnk-delete-module",function(e){e.preventDefault(),modular.hidePopover($(this));var $module=$(this).closest(".module"),te=$module.data("te"),modulesRackId=$module.data("modules_rack_id");modular.deleteModule(modulesRackId,$module,te)})},observePanelSelectorBtns:function(){$("#rack").on("click",".panel-selector > a",function(e){e.preventDefault(),modular.hidePopover($(this));var $module=$(this).closest(".module"),te=$module.data("te"),modulesRackId=$module.data("modules_rack_id"),direction=$(this).data("direction");modular.changePanel(modulesRackId,direction,$module,te)})},changePanel:function(modulesRackId,direction,$module,te){$.ajax({url:modular.config.baseUrl+"modules_racks/change_panel.json",dataType:"json",data:{modules_rack_id:modulesRackId,direction:direction},context:$module,beforeSend:function(){modular.showIndicator($module,"position: absolute; top: 50%; margin-top: -19px; left: "+Math.round(te/2*modular.rtd.gridColWidth)+"px;")},success:function(data){if(modular.hideIndicator(),!0===data.response.success){var resizeCommand="r";$("#mod"+data.response.result.ModulesRack.id).hasClass("module-1u")&&(resizeCommand="1u");var imgSrc=modular.getPanelImg(data.response.result.ModulesRack,resizeCommand),imgSrcSet=modular.getPanelImg(data.response.result.ModulesRack,resizeCommand+"@2x");$module.find("img").attr({src:imgSrc}),$module.find("img").attr({srcset:imgSrcSet+" 2x"});var $panelImgIndicator=modular.renderPanelImgIndicator(data.response.result.panelImgVersionPos,data.response.result.panelImgVersionQty);$module.find(".panel-img-version-indicator").replaceWith($panelImgIndicator),$("#rack").find(".module").removeClass("show-all-btns")}else data.response.msg&&modular.alert(data.response.msg)},error:function(data){modular.hideIndicator(),modular.alert(data)}})},getPanelImg:function(modulesRack,resizeCommand){var dirname=modular.config.domain+modular.config.webroot+"img/modcache/",imgUrl=dirname+modulesRack.module_id+"."+resizeCommand+".png";return"string"==typeof modulesRack.version_id&&(imgUrl=dirname+modulesRack.module_id+"_v"+modulesRack.version_id+"."+resizeCommand+".png"),imgUrl},renderPanelImgIndicator:function(panelImgVersionPos,panelImgVersionQty){var panelImgIndicatorText,indicatorClass="";return 0===panelImgVersionPos?(panelImgIndicatorText="HEAD",indicatorClass="badge-success"):panelImgIndicatorText=panelImgVersionPos+"/"+panelImgVersionQty,$("<div>").attr({class:"badge panel-img-version-indicator "+indicatorClass}).html(panelImgIndicatorText)},showModuleButtons:function($elmt){modular.hideModuleButtons();var closestModule=$elmt.closest(".module");!0===modular.rtd.isOwnedByUser&&0===modular.rtd.lockEnabled?(closestModule.addClass("show-all-btns"),1==modular.rtd.panelselectorEnabled&&$elmt.find(".panel-selector").show()):closestModule.addClass("show-public-btns"),modular.rtd.activeModuleRackId=closestModule.data("modules_rack_id");var module=[];module.modulesRackId=modular.rtd.activeModuleRackId,module.te=closestModule.data("te"),module.currentCol=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).attr("data-col")),module.currentRow=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).parent().parent().attr("data-row")),modular.rtd.moduleInFocus=module},hideModuleButtons:function(){var $activeModule=$("#mod"+modular.rtd.activeModuleRackId);$activeModule.removeClass("show-all-btns show-public-btns"),$activeModule.find(".panel-selector").hide()},deleteModule:function(modulesRackId,$module,te){$.ajax({url:modular.config.baseUrl+"modules_racks/delete.json",dataType:"json",data:{modules_rack_id:modulesRackId},context:$module,beforeSend:function(){modular.showIndicator($module,"position: absolute; top: 50%; margin-top: -19px; left: "+Math.round(te/2*modular.rtd.gridColWidth)+"px;")},success:function(data){modular.hideIndicator(),!0===data.response.success?(modular.deleteModuleMapKey(modulesRackId),modular.buildHtmlMap(),modular.selectFirstModule(),modular.updateTotals(modular.rtd.activeRackId),$module.remove(),modular.hideWorkbench(modulesRackId),modular.clearCanvasGuides()):data.response.msg&&modular.alert(data.response.msg)},error:function(data){modular.hideIndicator(),modular.alert(data)}})},findModules:function(url){var emptyResults,data={};$("#box-paginator").remove(),void 0===url?(url=modular.config.baseUrl+"modules/find",data={SearchName:$("#SearchName").val(),SearchVendor:$("#SearchVendor").val(),SearchFunction:$("#SearchFunction").val(),SearchSecondaryfunction:$("#SearchSecondaryfunction").val(),SearchHeight:$("#SearchHeight").val(),SearchTe:$("#SearchTe").val(),SearchTemethod:$("#form-search").find("[name ='data[Search][Temethod]']:checked").val(),SearchBuildtype:$("#SearchBuildtype").val(),SearchLifecycle:$("#SearchLifecycle").val(),SearchSet:$("#SearchSet").val(),SearchMarketplace:$("#SearchMarketplace").val(),SearchIsmodeled:$("#SearchIsmodeled").prop("checked")?1:0,SearchShowothers:$("#SearchShowothers").prop("checked")?1:0,order:modular.rtd.searchOrder,direction:modular.rtd.searchDirection},emptyResults=!0):(data={},emptyResults=!1),modular.rtd.request&&4!==modular.rtd.request.readyState&&modular.rtd.request.abort(),modular.rtd.request=$.ajax({url:url,dataType:"html",data:data,beforeSend:function(){$("#btn-search").button("loading")},success:function(html){!0===emptyResults&&($("#search-result").empty(),null===modular.rtd.activeRackId&&window.history.pushState&&window.history.pushState({html:html},"",modular.config.baseUrl+"modules/browser?"+$.param(data))),$("#btn-search").button("reset"),html&&($("#search-result").append(html),modular.enableEndlessScroll(function(){modular.disableEndlessScroll(),modular.findModules($("#lnk-next-results").attr("href"))}),modular.updateSearchResultCounter())},error:function(){$("#btn-search").button("reset")}})},findExistingModules:function(){var data;data={SearchName:$("#ModuleName").val(),SearchVendor:$("#ModuleVendorId").val()},modular.rtd.request&&4!==modular.rtd.request.readyState&&modular.rtd.request.abort(),modular.rtd.request=$.ajax({url:modular.config.baseUrl+"modules/find_existing_modules",dataType:"html",data:data,success:function(html){$("#search-result").html(html)}})},findRacks:function(url){var emptyResults,data={};$("#box-paginator").remove(),void 0===url?(url=modular.config.baseUrl+modular.rtd.searchCtrl+"/find",data={SearchName:$("#SearchName").val(),SearchRows:$("#SearchRows").val(),SearchSet:$("#SearchSet").val(),order:modular.rtd.searchOrder,direction:modular.rtd.searchDirection},emptyResults=!0):(data={},emptyResults=!1),modular.rtd.request&&4!==modular.rtd.request.readyState&&modular.rtd.request.abort(),modular.rtd.request=$.ajax({url:url,method:"GET",dataType:"html",data:data,beforeSend:function(){$("#btn-search").button("loading");var elmt=$("html");modular.showIndicator(elmt)},success:function(html){!0===emptyResults&&($("#search-result").empty(),window.history.pushState&&window.history.pushState({html:html},"",modular.config.baseUrl+modular.rtd.searchCtrl+"/index?"+$.param(data))),$("#btn-search").button("reset"),modular.hideIndicator(),html&&($("#search-result").append(html),modular.enableEndlessScroll(function(){modular.disableEndlessScroll(),modular.findRacks($("#lnk-next-results").attr("href"))}),modular.updateSearchResultCounter())},error:function(){$("#btn-search").button("reset")}})},updateSearchResultCounter:function(){$("#nav-sets").find(".search-count").text($("#search-count").data("searchCount"))},addModuleToRack:function($module){var moduleId;moduleId="object"==typeof $module?$module.data("module-id"):$module,$.ajax({url:modular.config.baseUrl+"modules_racks/add.json",cache:!1,dataType:"json",data:{moduleId:moduleId,rackId:modular.rtd.activeRackId},beforeSend:function(){if("object"==typeof $module){var elmt=$module.find(".thumb-img");elmt.length>0&&modular.showIndicator(elmt)}},success:function(data){if(modular.hideIndicator(),!0===data.response.success){modular.flyToRack(data),modular.updateTotals(modular.rtd.activeRackId);var $module=modular.renderModule(data.response.result.module);$("#modules").append($module),modular.addModuleMapKey({row:data.response.result.module.ModulesRack.row,col:data.response.result.module.ModulesRack.col},data.response.result.module.ModulesRack.id),modular.buildHtmlMap(),modular.enableDraggable($($module)),modular.clearCanvasGuides()}else data.response.msg?modular.alert(data.response.msg):debug("error")},error:function(data){modular.hideIndicator(),modular.alert(data)}})},addModuleToClipboard:function($module){var moduleId=$module.data("module-id"),te=$module.data("te");$.ajax({url:modular.config.baseUrl+"modules/add_to_clipboard.json",cache:!1,dataType:"json",data:{moduleId:moduleId},beforeSend:function(){modular.showIndicator($module,"position: absolute; top: 50%; margin-top: -19px; left: "+Math.round(te/2*modular.rtd.gridColWidth)+"px;")},success:function(data){modular.hideIndicator(),!0===data.response.success?debug("addedModuleToClipboard"):debug("error")},error:function(data){modular.hideIndicator(),modular.alert(data)}})},getModuleFromClipboard:function(){$.ajax({url:modular.config.baseUrl+"modules/get_from_clipboard.json",cache:!1,dataType:"json",success:function(data){!0===data.response.success?modular.addModuleToRack(data.response.result.moduleId):debug("error")},error:function(data){modular.alert(data)}})},flyToRack:function(data){var $moduleImg=$("#search-result").find(".box-module[data-module-id="+data.response.result.module.id+"] .lnk-thumb-img img"),sourcePosition=$moduleImg.offset();void 0===sourcePosition&&(sourcePosition={left:0,top:0});var targetPosition=$("#restraint").find(".grid-row[data-row="+data.response.result.module.ModulesRack.row+"]").find(".cell[data-col="+data.response.result.module.ModulesRack.col+"]").offset();if(void 0===targetPosition&&(targetPosition=$("#rack").offset()),void 0!==targetPosition){var moduleWidth=$moduleImg.width(),$clone=$moduleImg.clone(!1).appendTo("body").css({left:sourcePosition.left,top:sourcePosition.top,width:moduleWidth}).addClass("flying-module");setTimeout(function(){$clone.css({opacity:0,left:targetPosition.left,top:targetPosition.top})},5);var done=!1;$($clone).on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){modular.transitionEnded($clone),done=!0}),setTimeout(function(){!0!==done&&modular.transitionEnded($clone)},2e3)}},transitionEnded:function($elmt){$elmt.remove()},enableEndlessScroll:function(callback){var debounce_timer;$(window).on("scroll",function(){debounce_timer&&window.clearTimeout(debounce_timer),debounce_timer=window.setTimeout(function(){$(window).scrollTop()+$(window).height()>$(document).height()-200&&$("#box-paginator").find("a").length>0&&callback(),0===$(window).scrollTop()?$(".footer-static").fadeIn(300):$(".footer-static").fadeOut(300)},100)})},disableEndlessScroll:function(){$(window).off("scroll")},getModuleRating:function(moduleId,modalMode){modalMode=void 0===modalMode||modalMode,$.ajax({url:modular.config.baseUrl+"modules_users/get_user_rating.json",cache:!1,dataType:"json",data:{moduleId:moduleId},beforeSend:function(){},success:function(data){!0===data.response.success?!0===modalMode&&modular.renderModalStarRating(data):debug("error")},error:function(data){modular.alert(data)}})},deleteModuleRating:function(moduleId){$.ajax({url:modular.config.baseUrl+"modules_users/delete_user_rating.json",cache:!1,dataType:"json",data:{moduleId:moduleId},success:function(data){if(!0===data.response.success){var rateButton=$("#content-wrapper").find(".box-module[data-module-id='"+moduleId+"']").find(".btn-rate-module");rateButton.removeClass("btn-rated"),rateButton.find("i").removeClass("icon-white")}else debug("error")},error:function(data){modular.alert(data)}})},renderModalStarRating:function(data){$("#ratyModal").find(".modal-header h2").html("Rating <small>"+data.response.result.name+"</small>"),!1!==data.response.result.rating?$("#star").raty("score",data.response.result.rating):$("#star").raty("reload"),$("#ratyModal").modal("show")},setModuleRating:function(moduleId,rating,modalMode){modalMode=void 0===modalMode||modalMode,$.ajax({url:modular.config.baseUrl+"modules_users/set_user_rating.json",dataType:"json",cache:!1,data:{moduleId:moduleId,rating:rating},success:function(data){if(!0===data.response.success)if(!0===modalMode){var rateButton=$("#content-wrapper").find(".box-module[data-module-id='"+data.response.result.ModulesUser.module_id+"']").find(".btn-rate-module");rateButton.addClass("btn-rated"),rateButton.find("i").addClass("icon-white"),$("#ratyModal").modal("hide")}else $("#btn-delete-rating").removeClass("hidden");else debug("error")},error:function(data){modular.alert(data)}})},enableRaty:function(modalMode){var thing=modular.rtd.thing;modalMode=void 0===modalMode||modalMode,$("#star").raty({cancel:!1,target:"#hint",path:modular.config.webroot+"img/raty/",starOn:"star-on-big.png",starOff:"star-off-big.png",size:24,space:!0,hints:["This "+thing+" has some serious flaws.","This "+thing+" has some issues, either on functionality or build quality.","This "+thing+" is o.k. and really useful in some applications.","A great "+thing+" with just some minor spots to improve.","This "+thing+" is perfect. I take it on a desert island and will never let it go."],click:function(score){modular.setModuleRating($("#box-raty").data("module-id"),score,modalMode)},targetText:"I never owned or used this "+thing+".",targetKeep:!0})},observeRatingBtn:function(){$("#search-result").on("click",".btn-rate-module",function(e){e.preventDefault();var moduleId=$(this).closest(".box-module").data("module-id");$(this).hasClass("btn-rated")?modular.deleteModuleRating(moduleId):($("#box-raty").data("module-id",moduleId),modular.getModuleRating(moduleId))})},addModuleToCollection:function(moduleId){$.ajax({url:modular.config.baseUrl+"collections/add.json",dataType:"json",cache:!1,data:{moduleId:moduleId},success:function(data){if(!0===data.response.success){var collectionBtn=$("#content-wrapper").find(".box-module[data-module-id='"+data.response.result.module_id+"']").find(".btn-collection");collectionBtn.addClass("btn-rated"),collectionBtn.find("i").addClass("icon-white")}else debug(data.response.msg)},error:function(data){modular.alert(data)}})},observeCollectionBtn:function(){$("#search-result").on("click",".btn-collection",function(e){e.preventDefault();var moduleId=$(this).closest(".box-module").data("module-id");$(this).hasClass("btn-rated")?(debug("Module "+moduleId+" is already added by user."),modular.removeModuleFromCollection(moduleId)):modular.addModuleToCollection(moduleId)})},removeModuleFromCollection:function(moduleId){$.ajax({url:modular.config.baseUrl+"collections/remove.json",cache:!1,dataType:"json",data:{moduleId:moduleId},success:function(data){if(!0===data.response.success){var boxModule=$("#content-wrapper").find(".box-module[data-module-id='"+moduleId+"']");if("my"==$("#SearchSet").val())boxModule.remove();else{var collectionBtn=boxModule.find(".btn-collection");collectionBtn.blur(),collectionBtn.removeClass("btn-rated"),collectionBtn.find("i").removeClass("icon-white")}}else debug("error")},error:function(data){modular.alert(data)}})},initPopover:function(elmt){elmt.popover({trigger:"manual",placement:modular.wheretoplace(elmt),delay:{show:500,hide:0}})},wheretoplace:function(elmt){var col=elmt.attr("data-col");return modular.rtd.rack.Rack.te/5<col?"left":"bottom"},hidePopover:function(elmt){1===modular.rtd.popoverEnabled&&elmt.closest(".module").popover("hide")},enableKbdShortcuts:function(saveState){$("#OptionKbdShortcutsState").prop("checked",!0),modular.rtd.kbdShortcutsEnabled=1,!0===modular.rtd.rackIsEditable?(modular.initKeyboardMode(),$("#form-search").find("input, select").on("focus.keyboardShortcut",function(){"off"!==modular.rtd.kbdMode&&modular.disableKeyboardModuleSelectMode()})):modular.initPublicKeyboardMode(),1==saveState&&modular.saveBooleanState("kbdshortcuts",modular.rtd.kbdShortcutsEnabled)},disableKbdShortcuts:function(){$("#OptionKbdShortcutsState").prop("checked",!1),modular.rtd.kbdShortcutsEnabled=0,$("#rack").off("mouseenter.keyboardShortcut"),$("#form-search").find("input, select").off("focus.keyboardShortcut"),modular.saveBooleanState("kbdshortcuts",modular.rtd.kbdShortcutsEnabled)},enablePopover:function(saveState){$("#OptionPopoverState").prop("checked",!0),modular.rtd.popoverEnabled=1,$("#modules").on("mouseenter",".handle",function(e){e.preventDefault(),$(this).closest(".module").popover("show")}),$("#modules").on("mouseleave",".handle",function(e){e.preventDefault(),$(this).closest(".module").popover("hide")}),1==saveState&&modular.saveBooleanState("popover",modular.rtd.popoverEnabled)},disablePopover:function(){$("#OptionPopoverState").prop("checked",!1),modular.rtd.popoverEnabled=0,$("#modules").off("mouseenter"),$("#modules").off("mouseleave"),modular.hideModuleButtons(),modular.saveBooleanState("popover",modular.rtd.popoverEnabled)},enableSpaceguides:function(saveState){$("#OptionSpaceguidesState").prop("checked",!0),modular.rtd.spaceguidesEnabled=1,1==saveState&&modular.saveBooleanState("spaceguides",modular.rtd.spaceguidesEnabled)},disableSpaceguides:function(){$("#OptionSpaceguidesState").prop("checked",!1),modular.rtd.spaceguidesEnabled=0,modular.clearCanvasGuides(),modular.saveBooleanState("spaceguides",modular.rtd.spaceguidesEnabled)},enablePanelselector:function(saveState){$("#OptionPanelselectorState").prop("checked",!0),modular.rtd.panelselectorEnabled=1,1==saveState&&modular.saveBooleanState("panelselector",modular.rtd.panelselectorEnabled)},disablePanelselector:function(){$("#OptionPanelselectorState").prop("checked",!1),modular.rtd.panelselectorEnabled=0,modular.saveBooleanState("panelselector",modular.rtd.panelselectorEnabled)},enableLock:function(saveState){modular.hideModuleButtons(),$("#OptionLockState").prop("checked",!0),modular.rtd.lockEnabled=1,1==saveState&&modular.saveBooleanState("lock",modular.rtd.lockEnabled),$("#modules").find(".module").draggable("disable")},disableLock:function(){$("#OptionLockState").prop("checked",!1),modular.rtd.lockEnabled=0,modular.saveBooleanState("lock",modular.rtd.lockEnabled),$("#modules").find(".module").draggable("enable")},saveBooleanState:function(key,value){$.ajax({url:modular.config.baseUrl+"users/change_boolean_state.json",method:"GET",cache:!1,dataType:"json",data:{key:key,value:value},error:function(data){modular.alert(data)}})},updateTotals:function(rackId){$.ajax({url:modular.config.baseUrl+"racks/totals.json",cache:!1,dataType:"json",data:{rackId:rackId},success:function(data){!0===data.response.success?($("#current_plus").text(data.response.result.totals.current_plus),$("#current_min").text(data.response.result.totals.current_min),$("#current5v").text(data.response.result.totals.current5v),$("#maxdepth").text(data.response.result.totals.maxdepth),$("#qtyModules").text(data.response.result.totals.qtyModules),"eur"===modular.config.currency?$("#totalprice").html(data.response.result.totals.price_eur):$("#totalprice").html(data.response.result.totals.price_usd),void 0===data.response.result.totals.incompletes?$("#alert-incomplete-power-consumption").addClass("hidden"):($("#incompletesText").html(data.response.result.totals.incompletesText),$("#alert-incomplete-power-consumption").removeClass("hidden"))):debug("error")},error:function(data){modular.alert(data)}})},initKeyboardMode:function(){!0!==modular.rtd.isTouchDevice?(debug("no touch device - initKeyboardMode"),modular.switchKbMode("off"),modular.buildHtmlMap(),modular.listenToMouseEnter(),modular.listenToMouseLeave()):debug("touch device - ignore KeyboardMode")},listenToMouseEnter:function(){var rack=[];rack.te=parseInt(modular.rtd.rack.Rack.te,10),rack.rows=parseInt(modular.rtd.rack.Rack.rows,10),$("#rack").on("mouseenter.keyboardShortcut",function(){$("#form-search input").blur(),$(document.documentElement).off("keydown").on("keydown",function(e){-1!=modular.config.registeredKeys.indexOf(e.keyCode)&&(e.preventDefault(),e.stopPropagation()),"off"===modular.rtd.kbd.mode&&modular.enableKeyboardModuleSelectMode(),0===modular.rtd.lockEnabled&&modular.listenToDestructiveShortcuts(e,rack),modular.listenToSaveShortcuts(e)})})},listenToMouseLeave:function(){$("#rack").on("mouseleave",function(){modular.disableKeyboardModuleMoveMode(),modular.disableKeyboardModuleSelectMode(),$(document.documentElement).off("keydown")})},listenToSaveShortcuts:function(e){switch(modular.rtd.kbd.mode){case"select":if(27===e.keyCode)modular.disableKeyboardModuleSelectMode();else if(37===e.keyCode){modular.hidePopover($("#mod"+modular.rtd.activeModuleRackId));var prevModuleId=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).prev().attr("id"),10);!1===isNaN(prevModuleId)?modular.showModuleButtons($("#mod"+prevModuleId)):modular.findModuleInPrevRow()}else if(38===e.keyCode)modular.hidePopover($("#mod"+modular.rtd.activeModuleRackId)),modular.findModuleInPrevRow();else if(39===e.keyCode||9===e.keyCode){modular.hidePopover($("#mod"+modular.rtd.activeModuleRackId));var nextModuleId=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).next().attr("id"),10);!1===isNaN(nextModuleId)?modular.showModuleButtons($("#mod"+nextModuleId),1):modular.findModuleInNextRow()}else 40===e.keyCode?(modular.hidePopover($("#mod"+modular.rtd.activeModuleRackId)),modular.findModuleInNextRow()):90===e.keyCode&&(debug("z - zoom"),modular.zoomModule());"number"==typeof modular.rtd.activeModuleRackId&&(67===e.keyCode&&(debug("c - copy"),modular.addModuleToClipboard($("#mod"+modular.rtd.activeModuleRackId))),88===e.keyCode&&(debug("x - cut"),modular.addModuleToClipboard($("#mod"+modular.rtd.activeModuleRackId))))}},listenToDestructiveShortcuts:function(e,rack){var module={};switch(modular.rtd.kbd.mode){case"select":module=modular.rtd.moduleInFocus;break;case"move":module=modular.rtd.kbd.move.module}switch(86===e.keyCode&&(debug("v - paste"),modular.getModuleFromClipboard()),modular.rtd.kbd.mode){case"select":if(13===e.keyCode)modular.rtd.$draggable=$("#mod"+modular.rtd.activeModuleRackId),modular.enableKeyboardModuleMoveMode(),modular.clearCanvasGuides();else if(8===e.keyCode||46===e.keyCode||88===e.keyCode)modular.hidePopover($("#mod"+modular.rtd.activeModuleRackId)),modular.rtd.$draggable=$("#mod"+modular.rtd.activeModuleRackId),void 0!==modular.rtd.activeModuleRackId&&modular.deleteModule(modular.rtd.activeModuleRackId,modular.rtd.$draggable,modular.rtd.$draggable.data("te"));else if(68===e.keyCode)modular.addModuleToRack($("#mod"+modular.rtd.activeModuleRackId));else if(70===e.keyCode){var $module=$("#mod"+modular.rtd.activeModuleRackId),orientation=(parseInt($module.data("orientation"))+180)%360;$module.data("orientation",orientation),modular.hidePopover($("#mod"+modular.rtd.activeModuleRackId)),modular.rotateModule($module,modular.rtd.activeModuleRackId,orientation)}break;case"move":$module=modular.rtd.kbd.move.$module;37===e.keyCode?(module.currentCol>1?module.currentCol--:module.currentCol=rack.te-module.te+1,$module.css({left:modular.moduleColToLeft(module.currentCol)+"px"})):38===e.keyCode?(module.currentRow>1?module.currentRow--:module.currentRow=rack.rows,$module.css({top:modular.moduleRowToTop(module.currentRow)+"px"})):39===e.keyCode?(module.currentCol<rack.te-module.te+1?module.currentCol++:module.currentCol=1,$module.css({left:modular.moduleColToLeft(module.currentCol)+"px"})):40===e.keyCode?(module.currentRow<rack.rows?module.currentRow++:module.currentRow=1,$module.css({top:modular.moduleRowToTop(module.currentRow)+"px"})):27===e.keyCode?modular.resetModulePosition():13===e.keyCode&&(modular.moduleDrop($module,module.currentRow,module.currentCol),modular.disableKeyboardModuleMoveMode()),modular.runCollisionDetection($module),"number"!=typeof module.te||isNaN(module.currentRow)||modular.calculateSpaceguides(module)}var space={},destCol=0;-1==modular.rtd.modulesOutOfBounds.indexOf(modular.rtd.activeModuleRackId)&&(188===e.keyCode?(space=modular.calcSurroundingSpace(module),destCol=module.currentCol-space.left,modular.pushModuleToBoundaries(module,destCol)):190===e.keyCode&&(space=modular.calcSurroundingSpace(module),destCol=module.currentCol+space.right,modular.pushModuleToBoundaries(module,destCol)))},initPublicKeyboardMode:function(){modular.switchKbMode("off"),modular.buildHtmlMap(),$("#rack").on("mouseenter",function(){$(document.documentElement).off("keydown").on("keydown",function(e){-1!=modular.config.registeredKeys.indexOf(e.keyCode)&&(e.preventDefault(),e.stopPropagation()),"off"===modular.rtd.kbd.mode&&modular.enableKeyboardModuleSelectMode(),modular.listenToSaveShortcuts(e)})})},enableKeyboardModuleSelectMode:function(){modular.switchKbMode("select"),isNaN(modular.rtd.activeModuleRackId)?modular.selectFirstModule():modular.showModuleButtons($("#mod"+modular.rtd.activeModuleRackId))},disableKeyboardModuleSelectMode:function(){modular.switchKbMode("off"),modular.rtd.isTouchDevice||modular.hideModuleButtons(),modular.hideFullsizeModule()},enableKeyboardModuleMoveMode:function(){var $module;modular.switchKbMode("move"),modular.hidePopover($("#mod"+modular.rtd.activeModuleRackId)),modular.hideModuleButtons(),$("#mod"+modular.rtd.activeModuleRackId).addClass("kbd-move");var module=[];null!==modular.rtd.$draggable?$module=modular.rtd.$draggable:debug("no draggable defined"),module.currentCol=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).attr("data-col")),module.currentRow=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).parent().parent().attr("data-row")),module.modulesRackId=modular.rtd.activeModuleRackId,module.te=parseInt($module.data("te")),modular.rtd.kbd.move={},modular.rtd.kbd.move.$module=$module,modular.rtd.kbd.move.module=module},disableKeyboardModuleMoveMode:function(){$("#mod"+modular.rtd.activeModuleRackId).removeClass("kbd-move"),modular.enableKeyboardModuleSelectMode()},pushModuleToBoundaries:function(module,destCol){var $elmt=$("#mod"+module.modulesRackId);modular.moveModule($elmt,module.modulesRackId,module.currentRow,destCol),$elmt.css({left:modular.moduleColToLeft(destCol)+"px"}),module.currentCol=destCol,modular.calculateSpaceguides(module)},findModuleInPrevRow:function(){var prevModuleId=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).parent().parent().prev().find("ul:first li:last").attr("id"),10);!1===isNaN(prevModuleId)&&modular.showModuleButtons($("#mod"+prevModuleId))},findModuleInNextRow:function(){var nextModuleId=parseInt($(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).parent().parent().next().find("ul:first li:first").attr("id"),10);!1===isNaN(nextModuleId)&&modular.showModuleButtons($("#mod"+nextModuleId))},buildHtmlMap:function(){var keys,ul=[],li=[];$.each(modular.rtd.moduleMapObj,function(rowIndex,row){(keys=Object.keys(modular.rtd.moduleMapObj[rowIndex])).sort(function(a,b){return a-b}),$.each(keys,function(index,col){li.push("<li id='"+modular.rtd.moduleMapObj[rowIndex][col]+"' data-col='"+col+"' />")}),ul.push("<li data-row='"+rowIndex+"'><ul>"+li.join("")+"</ul></li>"),li=[]}),modular.rtd.moduleMap="<ul>"+ul.join("")+"</ul>"},selectFirstModule:function(){var activeRackCol=$(modular.rtd.moduleMap).find("li:first").find("li:first");modular.rtd.activeModuleRackId=parseInt(activeRackCol.attr("id"),10),modular.showModuleButtons($("#mod"+modular.rtd.activeModuleRackId))},resetModulePosition:function(){debug("resetModulePosition");var module=[];module.col=$(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).attr("data-col"),module.row=$(modular.rtd.moduleMap).find("#"+modular.rtd.activeModuleRackId).parent().parent().attr("data-row"),void 0===module.col?modular.rtd.$draggable.draggable("option","revert",!0):modular.rtd.$draggable.css({top:modular.moduleRowToTop(module.row)+"px",left:modular.moduleColToLeft(module.col)+"px"}),modular.clearCanvasGuides(),modular.disableKeyboardModuleMoveMode()},updateModuleMap:function(elmt,data){var modulesRackId=elmt.attr("data-modules_rack_id");modular.deleteModuleMapKey(modulesRackId),modular.addModuleMapKey(data,modulesRackId)},deleteModuleMapKey:function(modulesRackId){var module=[];module.col=parseInt($(modular.rtd.moduleMap).find("#"+modulesRackId).attr("data-col"),10),module.row=parseInt($(modular.rtd.moduleMap).find("#"+modulesRackId).parent().parent().attr("data-row"),10),modular.rtd.moduleMapObj[module.row]&&delete modular.rtd.moduleMapObj[module.row][module.col]},addModuleMapKey:function(data,modulesRackId){void 0===modular.rtd.moduleMapObj[data.row]&&(modular.rtd.moduleMapObj[data.row]={}),modular.rtd.moduleMapObj[data.row][data.col]=modulesRackId},switchKbMode:function(mode){modular.rtd.kbd.mode=mode},updateScreenshots:function(){$.each(modular.rtd.racks,function(index,rack){(rack.Rack.modified>rack.Rack.modifiedthumb||null===rack.Rack.modifiedthumb)&&modular.updateScreenshot(rack.Rack.id)})},updateScreenshotsWhenMissing:function(){$.each(modular.rtd.racks,function(index,rack){null===rack.Rack.modifiedthumb&&modular.updateScreenshot(rack.Rack.id)})},updateScreenshot:function(rackId){$.ajax({url:modular.config.baseUrl+"racks/get_screenshot/"+rackId+".json",cache:!1,dataType:"json",beforeSend:function(){modular.showIndicator($("a.lnk-rack[data-rack-id="+rackId+"]"))},success:function(data){if(modular.hideIndicator($("a.lnk-rack[data-rack-id="+rackId+"]")),!0===data.response.success){var wrapElmt=$("a.lnk-rack[data-rack-id="+rackId+"]");modular.refreshPictureTag(wrapElmt)}else debug(data.response.statusText)},error:function(data){modular.hideIndicator($("a.lnk-rack[data-rack-id="+rackId+"]"));var errorMsg="Unknown Error: cannot update screenshot";throw void 0!==data.responseJSON?errorMsg=data.responseJSON.message:data.statusText&&(errorMsg=data.statusText),new Error(errorMsg)}})},refreshPictureTag:function(wrapElmt){var currentSrc=wrapElmt.find("img").prop("src");-1==currentSrc.search("@2x.png")&&(currentSrc=currentSrc.replace(".png","@2x.png"));var url=new URL(currentSrc);url.searchParams.set("ts",(new Date).getTime()),wrapElmt.find("img").replaceWith($("<img>").attr({src:url})),wrapElmt.find("picture").replaceWith($("<img>").attr({src:url}))},getGoogleWigglerResults:function(moduleName){$.ajax({url:modular.config.baseUrl+"modules/get_google_results.json",data:{query:moduleName},dataType:"json",success:function(data){if(1==data.response.success){var li=new Array;$.each(data.response.result,function(index,story){li.push('<li><a target="_blank" href="'+story.url+'">'+story.title+"</a></li>")});var ul="<ul>"+li.join("")+"</ul>";$("#google-search-results").find("div").append($("<div>").append("<h3>Threads on Muffwiggler</h3>").append(ul).append("<p>Results from Google</p>"))}}})},setDisabledStateOfCurrentFields:function(isChecked){!0===isChecked?$(".group-current").attr("disabled","disabled"):$(".group-current").removeAttr("disabled")},observeOfferForm:function(){function changeCurrencyLabel(currency){$(".add-on-currency").text(currency)}$("#OfferCurrency").on("change",function(e){changeCurrencyLabel($(this).val())}),changeCurrencyLabel($("#OfferCurrency").val()),modular.getOfferPreview(),$("#lnk-preview").on("click",function(e){e.preventDefault(),modular.getOfferPreview()}),$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")})},getOfferPreview:function(){$.ajax({url:modular.config.baseUrl+"offers/preview",type:"post",cache:!1,dataType:"html",data:$("#OfferForm").serialize(),beforeSend:function(){modular.showIndicator($("#preview"))},success:function(data){modular.hideIndicator(),$("#preview").html(data)},error:function(data){modular.hideIndicator(),modular.alert(data)}})},show1UCheckboxes:function(row){var checkboxes=$("#cbrows1u > div.input > div.checkbox");checkboxes.hide(),checkboxes.slice(0,row).show()},observeMarkdownPreviewForFieldId:function(previewFieldId){$("#lnk-preview").on("click",function(e){e.preventDefault();var previewText=$("#"+previewFieldId).val();$.ajax({url:modular.config.baseUrl+"modules/preview",type:"post",cache:!1,dataType:"html",data:{text:previewText},beforeSend:function(){modular.showIndicator($("#preview"))},success:function(data){modular.hideIndicator(),$("#preview").html(data)},error:function(data){modular.hideIndicator(),modular.alert(data)}})}),$("#preview").on("click","#btn-cancel",function(e){e.preventDefault(),$("#preview").empty()})},getManufacturerPartial:function(){var vendorId=parseInt($("#SearchVendor").val());isNaN(vendorId)||$.ajax({url:"/e/vendors/banner/"+vendorId,dataType:"html",success:function(html){$("#vendor-info").html(html)}})},observePedalDimensionInputs:function(idPrefix){$(idPrefix+"WidthInch").keyup(function(e){$(idPrefix+"Width").val(modular.inchToMm($(this).val()))}),$(idPrefix+"HeightInch").keyup(function(e){$(idPrefix+"Height").val(modular.inchToMm($(this).val()))}),$(idPrefix+"Width").keyup(function(e){$(idPrefix+"WidthInch").val(modular.mmToInch($(this).val()))}),$(idPrefix+"Height").keyup(function(e){$(idPrefix+"HeightInch").val(modular.mmToInch($(this).val()))})},valueParse:function(val){return val=parseFloat(val),isNaN(val)&&(val=0),val},mmToInch:function(mm){return Math.round(modular.valueParse(mm)/25.4*100)/100},inchToMm:function(inch){return Math.round(25.4*modular.valueParse(inch))},setOrderLinkActive:function(){$("#search-order").find("li").removeClass("active"),$("#lnk-order-"+modular.rtd.searchOrder).addClass("active"),$("#lnk-order-"+modular.rtd.searchOrder).find("a").attr("class",modular.rtd.searchDirection)},observeNavSet:function(){$("#nav-sets").find("a").on("click",function(e){e.preventDefault();var id=$(this).attr("id");$(this).closest("ul").find("li").removeClass("active"),$(this).closest("li").addClass("active"),"nav-my-things"==id?$("#SearchSet").val("my"):$("#SearchSet").val("all"),$("#form-search").submit()})},copyToClipboard:function(text){if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",text);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var textarea=document.createElement("textarea");textarea.textContent=text,textarea.style.position="fixed",document.body.appendChild(textarea),textarea.select();try{return document.execCommand("copy")}catch(ex){return console.warn("Copy to clipboard failed.",ex),!1}finally{document.body.removeChild(textarea)}}},zoomModule:function(){if($("#wrap-fs-module").is(":visible"))modular.hideFullsizeModule();else{var moduleId=$("#mod"+modular.rtd.activeModuleRackId).data("module-id"),modulePos=$("#mod"+modular.rtd.activeModuleRackId).position();if(void 0!==modulePos){var fullsizeModule=new Image;fullsizeModule.src="/img/modcache/"+moduleId+".f.jpg",fullsizeModule.onload=function(){$("#wrap-fs-module").html(this);var topPos=modulePos.top-this.height/2;topPos<0&&(topPos=0),$("#wrap-fs-module").css({width:this.width,top:topPos}),$("#wrap-fs-module").removeClass("hidden"),$("#rack").one("click",function(e){e.preventDefault(),e.stopPropagation(),modular.hideFullsizeModule()})}}}},hideFullsizeModule:function(){$("#wrap-fs-module").addClass("hidden")},observeModuleZoomBtn:function(){$("#rack").on("click",".lnk-zoom-module",function(e){e.preventDefault();$(this).closest(".module").data("modules_rack_id");modular.hidePopover($(this)),modular.zoomModule()})},getInlineJsonData:function(dataSelect){try{const inlineJsonElement=document.querySelector('script[type="application/json"][data-mg-json="'+dataSelect+'"]');return JSON.parse(inlineJsonElement.textContent)}catch(err){console.error("Could not read JSON data from "+dataSelect,err)}},checkCookieConsent:function(){if($("#alert-cookie").length){$("#btn-cookie-consent").on("click",function(e){var cookieConsent;e.preventDefault(),Cookies.set("cookieConsent",1,{expires:3650}),"string"==typeof(cookieConsent=Cookies.get("cookieConsent"))&&1==cookieConsent?$("#alert-cookie").remove():$("#alert-cookie").find(".alert-text").html("<strong>It does not work, technical reasons or whatever.</strong>")})}},getHtmlViaAjax:function(url,updateElmt,callback){$.ajax({url:url,method:"GET",dataType:"html",beforeSend:function(){modular.showIndicator($(updateElmt))},success:function(data){modular.hideIndicator(),$(updateElmt).html(data),"function"==typeof callback&&callback()}})},observePostlinks:function(){$("body").on("click",".btn-pl",function(e){var confirmMsg=$(this).data("confirm-msg");return void 0===confirmMsg||!confirmMsg.length||confirm(confirmMsg)})},observeAnonymousLogout:function(){1==modular.config.is_anonymous&&$("#lnk-logout").on("click",function(e){e.preventDefault(),$("#modal-logout").modal("show")})},loadYouTubeIFrameAPI:function(){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)},observeYouTubeIframes:function(){jQuery("iframe").filter(function(){return 0==this.src.indexOf("https://www.youtube.com/")}).each(function(key,iframe){modular.addYouTubePlayer(key,iframe)})},addYouTubePlayer:function(id,iframe){id="embeddedvideo_"+id,$(iframe).attr("id",id),modular.rtd.ytPlayers.push(new YT.Player(id,{events:{onStateChange:function(event){event.data==YT.PlayerState.PLAYING&&$.each(modular.rtd.ytPlayers,function(k,v){this.getIframe().id!=event.target.getIframe().id&&this.pauseVideo()})}}}))}};try{Sentry.init({dsn:"https://4e3d5712323242789ffbe245fef72f1c@sentry.io/1333762"})}catch(e){console.error(e.message)}function onYouTubeIframeAPIReady(){modular.observeYouTubeIframes()}$(document).ready(function(){var baseConfig=modular.getInlineJsonData("base-config");modular.init(baseConfig)});try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(e){console.error(e.message)}var forum={init:function(settings){this.config={threadId:!1},this.rtd={},$.extend(this.config,settings)},observePostIndexBtns:function(){$(".btn-new-post").on("click",function(e){e.preventDefault(),forum.openEditor()}),$("#box-new-post").on("click","#btn-cancel",function(e){e.preventDefault(),forum.closeEditor()}),$(".btn-quote").on("click",function(e){e.preventDefault(),forum.openEditor($(this).data("post-id"))})},openEditor:function(quoteId){void 0===quoteId&&(quoteId=null),$.ajax({url:modular.config.baseUrl+"forum/posts/add/"+forum.config.threadId+"/"+quoteId,cache:!1,dataType:"html",beforeSend:function(){$(".btn-new-post").hide(),modular.showIndicator($("#box-new-post"),"position: absolute; left:50%; right:50%; top:30%; display: block;")},success:function(data){modular.hideIndicator(),window.location.href="#box-new-post",$("#box-new-post").html(data);const reCaptchaKey=modular.getInlineJsonData("recaptcha-key");mgRecaptcha.getToken(reCaptchaKey,"PostAddForm"),forum.observeCommonEditorBtns(),$(".btn-quote").off("click"),$(".btn-quote").on("click",function(e){e.preventDefault(),$.ajax({url:modular.config.baseUrl+"forum/posts/get_quote/"+$(this).data("post-id")+".json",cache:!1,dataType:"json",beforeSend:function(){modular.showIndicator($("#box-new-post"),"position: absolute; left:50%; right:50%; top:30%; display: block;")},success:function(data){if(modular.hideIndicator(),data.response.success){var fieldText=$("#PostText").val();fieldText+=data.response.result,$("#PostText").val(fieldText)}},error:function(data){modular.hideIndicator(),data.statusText&&modular.alert(data.statusText)}})})},error:function(data){modular.hideIndicator(),data.statusText&&modular.alert(data.statusText)}})},closeEditor:function(){$(".btn-new-post").show(),$("#box-new-post").empty(),$(".btn-quote").off("click"),$(".btn-quote").on("click",function(e){e.preventDefault(),forum.openEditor($(this).data("post-id"))})},observePostAddForm:function(){$("#box-new-post").on("click","#lnk-preview",function(e){e.preventDefault(),forum.getPreview()})},getPreview:function(){$.ajax({url:modular.config.baseUrl+"forum/posts/preview",type:"post",cache:!1,dataType:"html",data:$("#PostAddForm").serialize(),beforeSend:function(){modular.showIndicator($("#preview"))},success:function(data){modular.hideIndicator(),$("#preview").html(data)},error:function(data){modular.hideIndicator(),data.statusText&&modular.alert(data.statusText)}})},observePostEditForm:function(){$("#lnk-preview").on("click",function(e){e.preventDefault(),$.ajax({url:modular.config.baseUrl+"forum/posts/preview",type:"post",cache:!1,dataType:"html",data:$("#PostEditForm").serialize(),beforeSend:function(){modular.showIndicator($("#preview"))},success:function(data){modular.hideIndicator(),$("#preview").html(data)},error:function(data){modular.hideIndicator(),data.statusText&&modular.alert(data.statusText)}})}),forum.observeCommonEditorBtns()},observeCommonEditorBtns:function(){$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")}),$("#lnk-emoticon-list").on("click",function(e){e.preventDefault(),$("#block-emoticons").toggleClass("hidden")}),forum.observeEmoticonList()},observeThreadAddForm:function(){$("#lnk-preview").on("click",function(e){e.preventDefault(),$.ajax({url:modular.config.baseUrl+"forum/threads/preview",type:"post",cache:!1,dataType:"html",data:$("#ThreadAddForm").serialize(),beforeSend:function(){modular.showIndicator($("#preview"),"position: relative; margin-top: 20px; margin-bottom: 40px; margin-left: auto; margin-right: auto; display: block;")},success:function(data){modular.hideIndicator(),$("#preview").html(data)},error:function(data){modular.hideIndicator(),data.statusText&&modular.alert(data.statusText)}})}),forum.observeCommonEditorBtns()},enableClickableTableRows:function(){$("tbody input, tbody a, tbody button").click(function(e){return e.stopPropagation(),!0}),$("tbody").on("click","tr",function(e){window.location.href=$(this).data("url")})},observeEmoticonList:function(){$("#list-emo .emo-block").on("click",function(e){e.preventDefault();var $textarea,selectedEmoBlock=$(this);selectedEmoBlock.addClass("emo-selected"),setTimeout(function(){selectedEmoBlock.removeClass("emo-selected")},75);var fieldText=($textarea=$("#PostText").length?$("#PostText"):$("#Post0Text")).val(),position=$textarea.getCursorPosition(),newContent=fieldText.substr(0,position)+":"+selectedEmoBlock.find("i").data("emo")+":"+fieldText.substr(position);$textarea.val(newContent)})}};$.fn.getCursorPosition=function(){var el=$(this).get(0),pos=0;if("selectionStart"in el)pos=el.selectionStart;else if("selection"in document){el.focus();var Sel=document.selection.createRange(),SelLength=document.selection.createRange().text.length;Sel.moveStart("character",-el.value.length),pos=Sel.text.length-SelLength}return pos};var ebay={scope:"section",renderSection:function(data){ebay._cb_findItemsAdvanced(data,function(item){var titleTrunc=jQuery.trim(item.title).substring(0,30).split(" ").slice(0,-1).join(" ");return'<div class="ebay-item text-center"><a title="Look up module on eBay" href="'+item.viewitem+'" target="_blank" rel="noopener"><img src="'+item.pic+'" alt class="img-responsive" />'+titleTrunc+"</a>"+item.currentPrice+"</div>"})},renderLeaderboard:function(data){ebay._cb_findItemsAdvanced(data,function(item){return'<div class="ebay-item"><a title="'+item.title+'" href="'+item.viewitem+'" target="_blank" rel="noopener"><img src="'+item.pic+'" alt class="img-responsive" /></a>'+item.currentPrice+"</div>"})},getOffers:function(keywords,countryCode){countryCode=void 0!==countryCode?countryCode:"US";var globalId=ebay.countryCodeToGlobalId(countryCode),callback=ebay.renderSection,entriesPerPage=6;"leaderboard"==ebay.scope&&(callback=ebay.renderLeaderboard,entriesPerPage=6),$.ajax({url:modular.config.baseUrl+"offers/ebay_listings.json",dataType:"json",data:{keywords:keywords,globalId:globalId,entriesPerPage:entriesPerPage},success:function(dataObj){void 0!==dataObj.data&&callback(dataObj.data)},error:function(data){debug(data)}})},_cb_findItemsAdvanced:function(data,wrapperFunc){if(data.errorMessage)debug(data.errorMessage[0].error[0].message[0]),$("#ebay-lead").hide();else if("Success"==data.findItemsAdvancedResponse[0].ack){for(var items=data.findItemsAdvancedResponse[0].searchResult[0].item||[],html=[],i=0;i<items.length;++i){var item=items[i];if(void 0!==item.galleryURL){if(item.pic=item.galleryURL[0].replace(/^http:\/\//i,"https://"),item.viewitem=item.viewItemURL,item.currentPrice="",void 0!==item.sellingStatus[0].currentPrice[0])switch(item.currentPrice=item.sellingStatus[0].currentPrice[0].__value__,item.currentCurrency=item.sellingStatus[0].currentPrice[0]["@currencyId"],item.currentCurrency){case"USD":item.currentPrice="$"+parseFloat(item.currentPrice).toFixed(0);break;case"EUR":item.currentPrice=parseFloat(item.currentPrice).toFixed(0)+" €";break;default:item.currentPrice=parseFloat(item.currentPrice).toFixed(2)+" "+item.currentCurrency}null!==item.title&&null!==item.viewitem&&html.push(wrapperFunc(item))}}"section"==ebay.scope&&html.length&&$("#sec-ebay").removeClass("hidden"),"leaderboard"==ebay.scope&&(0===html.length?$("#ebay-lead").hide():$("#ebay-lead").show()),document.getElementById("ebay-results").innerHTML=html.join("")}else debug(data.findItemsAdvancedResponse[0])},getOffersByCountry:function(keywords){var countryCode=Cookies.get("countryCode");void 0===countryCode?(debug("no country for old man"),$.ajax({type:"GET",url:"https://freegeoip.net/json/",success:function(data){void 0!==data.country_code&&(Cookies.set("countryCode",data.country_code,{expires:7}),ebay.getOffers(keywords,data.country_code))}})):ebay.getOffers(keywords,countryCode)},countryCodeToGlobalId:function(countryCode){var globalId;switch(countryCode){case"AT":globalId="EBAY-AT";break;case"AU":globalId="EBAY-AU";break;case"CH":globalId="EBAY-CH";break;case"DE":globalId="EBAY-DE";break;case"CA":globalId="EBAY-ENCA";break;case"ES":globalId="EBAY-ES";break;case"FR":globalId="EBAY-FR";break;case"GB":globalId="EBAY-GB";break;case"IE":globalId="EBAY-IE";break;case"IN":globalId="EBAY-IN";break;case"IT":globalId="EBAY-IT";break;case"MY":globalId="EBAY-MY";break;case"NL":globalId="EBAY-NL";break;case"BE":globalId="EBAY-NLBE";break;case"PH":globalId="EBAY-PH";break;case"PL":globalId="EBAY-PL";break;case"SG":globalId="EBAY-SG";break;case"US":globalId="EBAY-US";break;default:globalId="EBAY-US"}return globalId},getOffersForLeaderboard:function(countryIsoCode,defaultSearchTerm){var vendorSelect=document.getElementById("SearchVendor"),ebaySearchTerm=vendorSelect.options[vendorSelect.selectedIndex].text;"-"==ebaySearchTerm&&(ebaySearchTerm=defaultSearchTerm),ebay.scope="leaderboard",ebay.getOffers(ebaySearchTerm,countryIsoCode)}};!function(factory){var registeredInModuleLoader=!1;if("function"==typeof define&&define.amd&&(define(factory),registeredInModuleLoader=!0),"object"==typeof exports&&(module.exports=factory(),registeredInModuleLoader=!0),!registeredInModuleLoader){var OldCookies=window.Cookies,api=window.Cookies=factory();api.noConflict=function(){return window.Cookies=OldCookies,api}}}(function(){function extend(){for(var i=0,result={};i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes)result[key]=attributes[key]}return result}return function init(converter){function api(key,value,attributes){var result;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(attributes=extend({path:"/"},api.defaults,attributes)).expires){var expires=new Date;expires.setMilliseconds(expires.getMilliseconds()+864e5*attributes.expires),attributes.expires=expires}attributes.expires=attributes.expires?attributes.expires.toUTCString():"";try{result=JSON.stringify(value),/^[\{\[]/.test(result)&&(value=result)}catch(e){}value=converter.write?converter.write(value,key):encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),key=(key=(key=encodeURIComponent(String(key))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var stringifiedAttributes="";for(var attributeName in attributes)attributes[attributeName]&&(stringifiedAttributes+="; "+attributeName,!0!==attributes[attributeName]&&(stringifiedAttributes+="="+attributes[attributeName]));return document.cookie=key+"="+value+stringifiedAttributes}key||(result={});for(var cookies=document.cookie?document.cookie.split("; "):[],rdecode=/(%[0-9A-Z]{2})+/g,i=0;i<cookies.length;i++){var parts=cookies[i].split("="),cookie=parts.slice(1).join("=");this.json||'"'!==cookie.charAt(0)||(cookie=cookie.slice(1,-1));try{var name=parts[0].replace(rdecode,decodeURIComponent);if(cookie=converter.read?converter.read(cookie,name):converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent),this.json)try{cookie=JSON.parse(cookie)}catch(e){}if(key===name){result=cookie;break}key||(result[name]=cookie)}catch(e){}}return result}}return api.set=api,api.get=function(key){return api.call(api,key)},api.getJSON=function(){return api.apply({json:!0},[].slice.call(arguments))},api.defaults={},api.remove=function(key,attributes){api(key,"",extend(attributes,{expires:-1}))},api.withConverter=init,api}(function(){})}),function(){var undefined,LARGE_ARRAY_SIZE=200,FUNC_ERROR_TEXT="Expected a function",HASH_UNDEFINED="__lodash_hash_undefined__",MAX_MEMOIZE_SIZE=500,CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2,INFINITY=1/0,MAX_SAFE_INTEGER=9007199254740991,NAN=NaN,argsTag="[object Arguments]",arrayTag="[object Array]",asyncTag="[object AsyncFunction]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",nullTag="[object Null]",objectTag="[object Object]",proxyTag="[object Proxy]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",undefinedTag="[object Undefined]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,reLeadingDot=/^\./,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reTrim=/^\s+|\s+$/g,reEscapeChar=/\\(\\)?/g,reFlags=/\w*$/,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsOctal=/^0o[0-7]+$/i,reIsUint=/^(?:0|[1-9]\d*)$/,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var freeParseInt=parseInt,freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,freeProcess=moduleExports&&freeGlobal.process,nodeUtil=function(){try{return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;function addMapEntry(map,pair){return map.set(pair[0],pair[1]),map}function addSetEntry(set,value){return set.add(value),set}function arrayIncludes(array,value){return!!(null==array?0:array.length)&&function(array,value,fromIndex){return value==value?function(array,value,fromIndex){var index=fromIndex-1,length=array.length;for(;++index<length;)if(array[index]===value)return index;return-1}(array,value,fromIndex):function(array,predicate,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?1:-1);for(;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}(array,baseIsNaN,fromIndex)}(array,value,0)>-1}function arrayIncludesWith(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function baseIsNaN(value){return value!=value}function cacheHas(cache,key){return cache.has(key)}function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach(function(value,key){result[++index]=[key,value]}),result}function overArg(func,transform){return function(arg){return func(transform(arg))}}function setToArray(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=value}),result}var uid,arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=root["__core-js_shared__"],funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"",nativeObjectToString=objectProto.toString,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Buffer=moduleExports?root.Buffer:undefined,Symbol=root.Symbol,Uint8Array=root.Uint8Array,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined,getPrototype=overArg(Object.getPrototypeOf,Object),objectCreate=Object.create,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,symToStringTag=Symbol?Symbol.toStringTag:undefined,defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}(),nativeGetSymbols=Object.getOwnPropertySymbols,nativeIsBuffer=Buffer?Buffer.isBuffer:undefined,nativeKeys=overArg(Object.keys,Object),nativeMax=Math.max,nativeMin=Math.min,DataView=getNative(root,"DataView"),Map=getNative(root,"Map"),Promise=getNative(root,"Promise"),Set=getNative(root,"Set"),WeakMap=getNative(root,"WeakMap"),nativeCreate=getNative(Object,"create"),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),symbolProto=Symbol?Symbol.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined,symbolToString=symbolProto?symbolProto.toString:undefined;function lodash(){}var baseCreate=function(){function object(){}return function(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=undefined,result}}();function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}function assignValue(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(value!==undefined||key in object)||baseAssignValue(object,key,value)}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}function baseAssignValue(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG,isFlat=bitmask&CLONE_FLAT_FLAG,isFull=bitmask&CLONE_SYMBOLS_FLAG;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=function(array){var length=array.length,result=array.constructor(length);length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input);return result}(value),!isDeep)return function(source,array){var index=-1,length=source.length;array||(array=Array(length));for(;++index<length;)array[index]=source[index];return array}(value,result)}else{var tag=getTag(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value))return function(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}(value,isDeep);if(tag==objectTag||tag==argsTag||isFunc&&!object){if(result=isFlat||isFunc?{}:function(object){return"function"!=typeof object.constructor||isPrototype(object)?{}:baseCreate(getPrototype(object))}(value),!isDeep)return isFlat?function(source,object){return copyObject(source,getSymbolsIn(source),object)}(value,function(object,source){return object&&copyObject(source,keysIn(source),object)}(result,value)):function(source,object){return copyObject(source,getSymbols(source),object)}(value,function(object,source){return object&&copyObject(source,keys(source),object)}(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=function(object,tag,cloneFunc,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneArrayBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case dataViewTag:return function(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}(object,isDeep);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:return function(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}(object,isDeep);case mapTag:return function(map,isDeep,cloneFunc){return arrayReduce(isDeep?cloneFunc(mapToArray(map),CLONE_DEEP_FLAG):mapToArray(map),addMapEntry,new map.constructor)}(object,isDeep,cloneFunc);case numberTag:case stringTag:return new Ctor(object);case regexpTag:return(result=new(regexp=object).constructor(regexp.source,reFlags.exec(regexp))).lastIndex=regexp.lastIndex,result;case setTag:return function(set,isDeep,cloneFunc){return arrayReduce(isDeep?cloneFunc(setToArray(set),CLONE_DEEP_FLAG):setToArray(set),addSetEntry,new set.constructor)}(object,isDeep,cloneFunc);case symbolTag:return symbol=object,symbolValueOf?Object(symbolValueOf.call(symbol)):{}}var symbol;var regexp,result}(value,tag,baseClone,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked)return stacked;stack.set(value,result);var props=isArr?undefined:(isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys)(value);return function(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););}(props||value,function(subValue,key){props&&(subValue=value[key=subValue]),assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}),result}Hash.prototype.clear=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0},Hash.prototype.delete=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result},Hash.prototype.get=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED?undefined:result}return hasOwnProperty.call(data,key)?data[key]:undefined},Hash.prototype.has=function(key){var data=this.__data__;return nativeCreate?data[key]!==undefined:hasOwnProperty.call(data,key)},Hash.prototype.set=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&value===undefined?HASH_UNDEFINED:value,this},ListCache.prototype.clear=function(){this.__data__=[],this.size=0},ListCache.prototype.delete=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0||(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,0))},ListCache.prototype.get=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1]},ListCache.prototype.has=function(key){return assocIndexOf(this.__data__,key)>-1},ListCache.prototype.set=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this},MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}},MapCache.prototype.delete=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result},MapCache.prototype.get=function(key){return getMapData(this,key).get(key)},MapCache.prototype.has=function(key){return getMapData(this,key).has(key)},MapCache.prototype.set=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function(value){return this.__data__.set(value,HASH_UNDEFINED),this},SetCache.prototype.has=function(value){return this.__data__.has(value)},Stack.prototype.clear=function(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result},Stack.prototype.get=function(key){return this.__data__.get(key)},Stack.prototype.has=function(key){return this.__data__.has(key)},Stack.prototype.set=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<LARGE_ARRAY_SIZE-1)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this};var fromRight,baseFor=function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object};function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseGet(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:undefined}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}function baseGetTag(value){return null==value?value===undefined?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(value)?function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=undefined;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]);return result}(value):function(value){return nativeObjectToString.call(value)}(value)}function baseHasIn(object,key){return null!=object&&key in Object(object)}function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?arrayTag:getTag(object),othTag=othIsArr?arrayTag:getTag(other),objIsObj=(objTag=objTag==argsTag?objectTag:objTag)==objectTag,othIsObj=(othTag=othTag==argsTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case arrayBufferTag:return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=bitmask&COMPARE_PARTIAL_FLAG;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=COMPARE_UNORDERED_FLAG,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case symbolTag:if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(bitmask&COMPARE_PARTIAL_FLAG)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}if(!isSameTag)return!1;return stack||(stack=new Stack),function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,objProps=getAllKeys(object),objLength=objProps.length,othLength=getAllKeys(other).length;if(objLength!=othLength&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var stacked=stack.get(object);if(stacked&&stack.get(other))return stacked==other;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor)&&(result=!1)}return stack.delete(object),stack.delete(other),result}(object,other,bitmask,customizer,equalFunc,stack)}(value,other,bitmask,customizer,baseIsEqual,stack))}function baseIsNative(value){return!(!isObject(value)||maskSrcKey&&maskSrcKey in value)&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}function baseIteratee(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?function(path,srcValue){if(isKey(path)&&isStrictComparable(srcValue))return matchesStrictComparable(toKey(path),srcValue);return function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}(value[0],value[1]):function(source){var matchData=function(object){var result=keys(object),length=result.length;for(;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}(source);if(1==matchData.length&&matchData[0][2])return matchesStrictComparable(matchData[0][0],matchData[0][1]);return function(object){return object===source||function(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(result===undefined?baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG,customizer,stack):result))return!1}}return!0}(object,source,matchData)}}(value):property(value)}function baseKeysIn(object){if(!isObject(object))return function(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}function castPath(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new Uint8Array(result).set(new Uint8Array(arrayBuffer)),result}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;newValue===undefined&&(newValue=source[key]),isNew?baseAssignValue(object,key,newValue):assignValue(object,key,newValue)}return object}var createSet=Set&&1/setToArray(new Set([,-0]))[1]==INFINITY?function(values){return new Set(values)}:noop;function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var stacked=stack.get(array);if(stacked&&stack.get(other))return stacked==other;var index=-1,result=!0,seen=bitmask&COMPARE_UNORDERED_FLAG?new SetCache:undefined;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(compared!==undefined){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)})){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}function getAllKeys(object){return baseGetAllKeys(object,keys,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}function getIteratee(){var result=lodash.iteratee||iteratee;return result=result===iteratee?baseIteratee:result,arguments.length?result(arguments[0],arguments[1]):result}function getMapData(map,key){var value,type,data=map.__data__;return("string"==(type=typeof(value=key))||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value)?data["string"==typeof key?"string":"hash"]:data.map}function getNative(object,key){var value=function(object,key){return null==object?undefined:object[key]}(object,key);return baseIsNative(value)?value:undefined}var getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}(nativeGetSymbols(object),function(symbol){return propertyIsEnumerable.call(object,symbol)}))}:stubArray,getSymbolsIn=nativeGetSymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray,getTag=baseGetTag;function isIndex(value,length){return!!(length=null==length?MAX_SAFE_INTEGER:length)&&("number"==typeof value||reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isKey(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}function isPrototype(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function isStrictComparable(value){return value==value&&!isObject(value)}function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(srcValue!==undefined||key in Object(object)))}}(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&getTag(new Set)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag)&&(getTag=function(value){var result=baseGetTag(value),Ctor=result==objectTag?value.constructor:undefined,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return"[object Promise]";case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return result});var result,cache,stringToPath=(result=memoize(function(string){var result=[];return reLeadingDot.test(string)&&result.push(""),string.replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result},function(key){return cache.size===MAX_MEMOIZE_SIZE&&cache.clear(),key}),cache=result.cache,result);function toKey(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}var now=function(){return root.Date.now()};function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}function eq(value,other){return value===other||value!=value&&other!=other}memoize.Cache=MapCache;var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")},isArray=Array.isArray;function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}var isBuffer=nativeIsBuffer||stubFalse;function isFunction(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}function isObjectLike(value){return null!=value&&"object"==typeof value}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&baseGetTag(value)==symbolTag}var isTypedArray=nodeIsTypedArray?function(func){return function(value){return func(value)}}(nodeIsTypedArray):function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]};function toNumber(value){if("number"==typeof value)return value;if(isSymbol(value))return NAN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}function toString(value){return null==value?"":baseToString(value)}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,path);return result===undefined?defaultValue:result}function hasIn(object,path){return null!=object&&function(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}(object,path,baseHasIn)}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}(object)}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}function identity(value){return value}function iteratee(func){return baseIteratee("function"==typeof func?func:baseClone(func,CLONE_DEEP_FLAG))}function noop(){}function property(path){return isKey(path)?(key=toKey(path),function(object){return null==object?undefined:object[key]}):function(path){return function(object){return baseGet(object,path)}}(path);var key}function stubArray(){return[]}function stubFalse(){return!1}lodash.debounce=function(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=undefined,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return lastCallTime===undefined||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var result=wait-(time-lastCallTime);return maxing?nativeMin(result,maxWait-(time-lastInvokeTime)):result}(time))}function trailingEdge(time){return timerId=undefined,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=undefined,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(timerId===undefined)return function(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return timerId===undefined&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){timerId!==undefined&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=undefined},debounced.flush=function(){return timerId===undefined?result:trailingEdge(now())},debounced},lodash.iteratee=iteratee,lodash.keys=keys,lodash.keysIn=keysIn,lodash.memoize=memoize,lodash.property=property,lodash.uniqBy=function(array,iteratee){return array&&array.length?function(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}(array,getIteratee(iteratee,2)):[]},lodash.eq=eq,lodash.findKey=function(object,predicate){return function(collection,predicate,eachFunc){var result;return eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection))return result=key,!1}),result}(object,getIteratee(predicate,3),baseForOwn)},lodash.get=get,lodash.hasIn=hasIn,lodash.identity=identity,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isArrayLike=isArrayLike,lodash.isBuffer=isBuffer,lodash.isFunction=isFunction,lodash.isLength=isLength,lodash.isObject=isObject,lodash.isObjectLike=isObjectLike,lodash.isSymbol=isSymbol,lodash.isTypedArray=isTypedArray,lodash.stubArray=stubArray,lodash.stubFalse=stubFalse,lodash.noop=noop,lodash.now=now,lodash.toNumber=toNumber,lodash.toString=toString,lodash.VERSION="4.17.4","function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=lodash,define(function(){return lodash})):freeModule?((freeModule.exports=lodash)._=lodash,freeExports._=lodash):root._=lodash}.call(this);var mgRecaptcha={getToken:function(reCaptchaKey,action){console.log("mgRecaptcha: init getToken"),$("#submit-post").on("click",function(e){console.log("mgRecaptcha: Submit clicked"),e.preventDefault(),grecaptcha.ready(function(){grecaptcha.execute(reCaptchaKey,{action:action}).then(function(token){console.log("mgRecaptcha token received"),console.log(action),console.log(token),$("#g-recaptcha-response").val(token),$("#"+action).submit()})})})}},forums={init:function(){forums.observeResetBtn(),forums.checkTimezone()},observeResetBtn:function(){$("#btn-reset-query").click(function(e){e.preventDefault(),$("#SearchQuery").val(""),$("#form-search").submit()})},checkTimezone:function(){if($("#checkTimezone").length){var timezone=jstz.determine().name();$.post(modular.config.baseUrl+"users/set_timezone.json",{tz:timezone},function(data){1==data.response.success&&location.reload(!0)})}},forums_index:function(){forums.init(),forum.enableClickableTableRows()},threads_index:function(){forums.init(),forum.enableClickableTableRows()},threads_add:function(){const reCaptchaKey=modular.getInlineJsonData("recaptcha-key");mgRecaptcha.getToken(reCaptchaKey,"ThreadAddForm"),forum.observeThreadAddForm()},posts_index:function(){forums.init();var threadId=$("#addObj").data("thread-id");forum.init({threadId:threadId}),forum.observePostIndexBtns(),forum.observePostAddForm(),modular.loadYouTubeIFrameAPI()},posts_add:function(){const reCaptchaKey=modular.getInlineJsonData("recaptcha-key");mgRecaptcha.getToken(reCaptchaKey,"PostAddForm"),forums.init(),$("#lnk-preview").on("click",function(e){e.preventDefault(),forum.getPreview()}),forum.observeCommonEditorBtns()},posts_edit:function(){const reCaptchaKey=modular.getInlineJsonData("recaptcha-key");mgRecaptcha.getToken(reCaptchaKey,"PostEditForm"),forum.observePostEditForm()},getRequestedThread:function(threadId){if(threadId){forum.init({threadId:threadId});var callback=function(){forum.observePostIndexBtns(),forum.observePostAddForm()},url=modular.config.baseUrl+"forum/posts/index/"+threadId+"/page:1";$("#related-discussions").on("click",".paging a",function(e){e.preventDefault();var url=$(this).attr("href");modular.getHtmlViaAjax(url,"#related-discussions",callback)}),modular.getHtmlViaAjax(url,"#related-discussions",callback)}}},memories={game:function(){var memoryParams=modular.getInlineJsonData("memory-params");mem.init(memoryParams);var config=modular.getInlineJsonData("config");mem.config.memTexts=config.memTexts,$("a#resetMemory").click(function(e){e.preventDefault(),mem.resetGame()}),$("#memoModuleModal").on("hidden",function(){mem.resetGame()}),$("#highscore").on("click",".paging a",function(e){e.preventDefault();var url=$(this).attr("href");$.ajax({url:url,method:"GET",dataType:"html",beforeSend:function(){modular.showIndicator($("#highscore"))},success:function(data){modular.hideIndicator(),$("#highscore").html(data)}})}),$("#memoModuleModal").on("submit","#MemoryGameoverForm",function(e){e.preventDefault(),$.ajax({type:"POST",url:mem.config.webroot+"memomodule/memories/gameover.json",data:$(this).serialize(),beforeSend:function(){},success:function(data){1==data.response.success?(mem.reloadHighscore(),$("#memoModuleModal").modal("hide")):debug("Score Submit Error")}})})}},messages={add:function(){$("#lnk-preview").on("click",function(e){e.preventDefault(),$.ajax({url:modular.config.baseUrl+"messages/preview",type:"post",cache:!1,dataType:"html",data:$("#MessageAddForm").serialize(),beforeSend:function(){modular.showIndicator($("#preview"))},success:function(data){modular.hideIndicator(),$("#preview").html(data)},error:function(data){modular.hideIndicator(),data.statusText&&modular.alert(data.statusText)}})}),$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")})},bulkmsg:function(){$("#lnk-preview").on("click",function(e){e.preventDefault(),$.ajax({url:modular.config.baseUrl+"messages/preview",type:"post",cache:!1,dataType:"html",data:$("#MessageAddForm").serialize(),beforeSend:function(){modular.showIndicator($("#preview"))},success:function(data){modular.hideIndicator(),$("#preview").html(data)},error:function(data){modular.hideIndicator(),data.statusText&&modular.alert(data.statusText)}})}),$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")})},inbox:function(){this._resetSearchForm()},outbox:function(){this._resetSearchForm()},_resetSearchForm:function(){$("#btn-reset-search").click(function(e){e.preventDefault(),$("#form-search").find("input[type=text]").val(""),$("#form-search").submit()})}},modules={add:function(){$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")}),$("#ModuleIsPassive").on("click",function(e){modular.setDisabledStateOfCurrentFields($(this).is(":checked"))}),modular.setDisabledStateOfCurrentFields($("#ModuleIsPassive").is(":checked")),modular.observeMarkdownPreviewForFieldId("ModuleText"),$("#ModuleName").on("keyup",function(){modular.findExistingModules()}),$("#ModuleVendorId").on("change",function(){modular.findExistingModules()})},browser:function(){var settings=modular.getInlineJsonData("browser-settings");function findModules(url){modular.findModules(url)}function toggleAd(type){"ebay"==type?($("#lb-ebay").removeClass("hidden"),$("#lb-custom").addClass("hidden")):($("#lb-ebay").addClass("hidden"),$("#lb-custom").removeClass("hidden"))}$("#form-search").submit(function(e){e.preventDefault(),findModules()}),$("#btn-reset-search").click(function(e){e.preventDefault(),$("#form-search").find("input[type=text]").val(""),$("#form-search").find("input[type=number]").val(""),$("#SearchVendor, #SearchFunction, #SearchSecondaryfunction, #SearchBuildtype, #SearchLifecycle, #SearchMarketplace").prop("selectedIndex",0),$("#SearchIsmodeled").prop("checked",!1),$("#form-search").submit(),$("#vendor-info").empty(),toggleAd("custom")}),$("#btn-reset-mod-name").click(function(e){e.preventDefault(),$("#SearchName").val(""),$("#form-search").submit()}),$("#form-search input[type=checkbox], #form-search input[type=radio], #form-search select").on("change",function(e){"SearchFunction"!=this.id&&"SearchSecondaryfunction"!=this.id||(modular.rtd.searchDirection="asc",modular.rtd.searchOrder="tag",modular.setOrderLinkActive()),"SearchVendor"==this.id&&(""==$("#SearchVendor").val()?toggleAd("custom"):$("#ebay-results").length>0&&(debug("Search for eBay listings"),toggleAd("ebay"),ebay.getOffersForLeaderboard(settings.countryIsoCode,settings.formatName))),e.preventDefault(),$("#form-search").submit()}),$("#search-result").on("click","#lnk-next-results",function(e){e.preventDefault(),findModules($("#lnk-next-results").attr("href"))}),$("#search-result").on("click","#lnk-toggle-others",function(e){e.preventDefault();var otherCheckbox=$("#SearchShowothers");otherCheckbox.prop("checked",!otherCheckbox.prop("checked")),findModules()}),$("#search-order").on("click","a",function(e){e.preventDefault(),modular.rtd.searchOrder==$(this).data("search-order")&&("asc"==modular.rtd.searchDirection?modular.rtd.searchDirection="desc":modular.rtd.searchDirection="asc"),modular.rtd.searchOrder=$(this).data("search-order"),modular.setOrderLinkActive(),findModules()}),modular.rtd.searchOrder=settings.searchOrder,modular.rtd.searchDirection=settings.searchDirection,findModules(),modular.setOrderLinkActive(),modular.rtd.thing=settings.thing,modular.enableRaty(!0),modular.observeRatingBtn(),modular.observeCollectionBtn(),window.onpopstate=function(e){e.state&&(document.getElementById("search-result").innerHTML=e.state.html)},modular.observeNavSet()},home:function(){},mod_remap:function(){$(".lnk-mod-id").on("mouseup",function(e){e.preventDefault(),$("#ModuleTargetid").val($(this).data("id"))})},view:function(){var settings=modular.getInlineJsonData("settings");modular.rtd.thing=settings.thing,$(".btn-rate-module").on("click",function(e){e.preventDefault(),modular.getModuleRating($(this).data("module-id"))}),isotube.init({apiKey:settings.ytApiKey,searchmode:"title",searchterm:settings.ytSearchterm}),isotube.findVideos(),settings.ratyIsEnabled&&(modular.enableRaty(!1),settings.ratyUserVote&&($("#star").raty("score",settings.ratyUserVote),$("#btn-delete-rating").removeClass("hidden"))),ebay.getOffers(settings.ebaySearchterm,settings.countryIsoCode),$("a.lnk-help").popover({placement:"left"}),$("#related-racks").on("click",".paging a",function(e){e.preventDefault();var url=$(this).attr("href");modular.getHtmlViaAjax(url,"#related-racks")}),$("#offers").on("click","th a, .paging a",function(e){e.preventDefault();var url=$(this).attr("href");modular.getHtmlViaAjax(url,"#offers")}),forums.getRequestedThread(settings.threadId)}},offers={index:function(){$("#form-search").on("change",function(e){e.preventDefault(),$("#form-search").submit()})},add:function(){modular.observeOfferForm()},edit:function(){modular.observeOfferForm()},view:function(){$('[data-toggle="popover"]').popover()}},patches={index:function(){modular.rtd.searchCtrl="patches",$("#search-result").on("mouseenter mouseleave",".li-screenshot",function(e){$(this).find(".command-center-btns").toggleClass("visibility-hidden")}),$("#search-result").on("click",".btn-get-screenshot",function(e){e.preventDefault(),patches.updateScreenshot($(this).data("patch-id"))}),$("#form-search").submit(function(e){e.preventDefault(),modular.findRacks()}),$("#btn-reset-search").click(function(e){e.preventDefault(),$("#form-search").find("input[type=text]").val(""),$("#form-search").submit()}),$("#btn-reset-rack-name").click(function(e){e.preventDefault(),$("#SearchName").val(""),$("#form-search").submit()}),$("#search-result").on("click","#lnk-next-results",function(e){e.preventDefault(),modular.findRacks($("#lnk-next-results").attr("href"))}),$("#search-order").on("click","a",function(e){e.preventDefault(),modular.rtd.searchOrder==$(this).data("search-order")&&("asc"==modular.rtd.searchDirection?modular.rtd.searchDirection="desc":modular.rtd.searchDirection="asc"),modular.rtd.searchOrder=$(this).data("search-order"),modular.setOrderLinkActive(),modular.findRacks()}),modular.observeNavSet();const searchParamsDefault=modular.getInlineJsonData("search-params-default");modular.rtd.searchOrder=searchParamsDefault.order,modular.rtd.searchDirection=searchParamsDefault.direction,modular.setOrderLinkActive(),modular.enableEndlessScroll(function(){modular.disableEndlessScroll(),modular.findRacks($("#lnk-next-results").attr("href"))}),modular.updateSearchResultCounter()},view:function(){$("#kinetic").on("mousedown",function(e){e.preventDefault()});var settings=modular.getInlineJsonData("settings");sketch.init(settings),forums.getRequestedThread(settings.threadId)},minimal:function(){var settings=modular.getInlineJsonData("settings");sketch.init(settings)},updateScreenshot:function(patchId){$.ajax({url:modular.config.baseUrl+"patches/get_screenshot/"+patchId+".json",cache:!1,dataType:"json",beforeSend:function(){modular.showIndicator($("a.lnk-rack[data-patch-id="+patchId+"]"))},success:function(data){if(modular.hideIndicator($("a.lnk-rack[data-patch-id="+patchId+"]")),!0===data.response.success){var wrapElmt=$("a.lnk-rack[data-patch-id="+patchId+"]");modular.refreshPictureTag(wrapElmt)}else debug(data.response.statusText)},error:function(data){modular.hideIndicator($("a.lnk-rack[data-patch-id="+patchId+"]"));var errorMsg="Unknown Error: cannot update screenshot";throw void 0!==data.responseJSON?errorMsg=data.responseJSON.message:data.statusText&&(errorMsg=data.statusText),new Error(errorMsg)}})}},pedalboards={add:function(){pedalboards.edit()},edit:function(){function checkDisabledState(){$("#specific-pedalboards").find($("input[type='radio']")).filter(":checked").hasClass("flexible")?($("#PedalboardWidth").removeAttr("disabled"),$("#PedalboardHeight").removeAttr("disabled")):($("#PedalboardWidth").attr("disabled","disabled"),$("#PedalboardHeight").attr("disabled","disabled"))}$("#specific-pedalboards input[type=radio]").on("change",function(e){var width=$(this).data("width"),height=$(this).data("height");$("#PedalboardWidth").val(width),$("#PedalboardHeight").val(height),checkDisabledState()}),checkDisabledState()},view:function(){$.extend(modular,pedalboard),$.extend(modular.rtd,modular.getInlineJsonData("rtd")),modular.calcScaleFactor(),modular.initRack();var getBasicBoardDataDebounced=_.debounce(modular.getBasicBoardData,200);$(window).resize(function(){modular.calcScaleFactor(),getBasicBoardDataDebounced()});var settings=modular.getInlineJsonData("settings"),popoverState=settings.popoverState,panelselectorState=settings.panelselectorState,screenshotUrl=settings.screenshotUrl;1===popoverState&&modular.enablePopover(0),1===panelselectorState&&modular.enablePanelselector(0),modular.observePanelSelectorBtns(),$("#OptionPopoverState").on("change",function(e){e.preventDefault(),0==modular.rtd.popoverEnabled?modular.enablePopover(1):modular.disablePopover()}),$("#OptionPanelselectorState").on("change",function(e){e.preventDefault(),0==modular.rtd.panelselectorEnabled?modular.enablePanelselector(1):modular.disablePanelselector()}),modular.observeInfoBtn(),$("#lnk-copy-to-clipboard").on("click",function(e){e.preventDefault();var text=screenshotUrl;modular.copyToClipboard(text)&&modular.flatAlert("Copied Screenshot URL to Clipboard: "+text,"alert-success")}),modular.rtd.isOwnedByUser&&($("#search-result").on("click",".add-module",function(e){e.preventDefault(),modular.addModuleToRack($(this).closest(".box-module"))}),modular.enableDroppable(),modular.observeDeleteBtn(),modular.observeRotateBtn(),navigation.enclosingTab("Pedalboard"),modules.browser()),forums.getRequestedThread(settings.threadId)},minimal:function(){$.extend(modular,pedalboard),$.extend(modular.rtd,modular.getInlineJsonData("rtd")),modular.pbConfig.boardPadding=1.05,modular.calcScaleFactor(),modular.initRack()}},pedals={add:function(){$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")}),$("#ModuleIsPassive").on("click",function(e){modular.setDisabledStateOfCurrentFields($(this).is(":checked"))}),modular.setDisabledStateOfCurrentFields($("#ModuleIsPassive").is(":checked")),modular.observeMarkdownPreviewForFieldId("ModuleText"),modular.observePedalDimensionInputs("#Module"),$("#ModuleName").on("keyup",function(){modular.findExistingModules()}),$("#ModuleVendorId").on("change",function(){modular.findExistingModules()})},add_version:function(){$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")}),$("#VersionIsPassive").on("click",function(e){modular.setDisabledStateOfCurrentFields($(this).is(":checked"))}),modular.setDisabledStateOfCurrentFields($("#VersionIsPassive").is(":checked")),modular.observeMarkdownPreviewForFieldId("VersionText"),modular.observePedalDimensionInputs("#Version"),$("#VersionWidthInch").val(modular.mmToInch($("#VersionWidth").val())),$("#VersionHeightInch").val(modular.mmToInch($("#VersionHeight").val()))}},racks={index:function(){$("#search-result").on("mouseenter mouseleave",".li-screenshot",function(e){$(this).find(".command-center-btns").toggleClass("visibility-hidden")}),$("#search-result").on("click",".btn-get-screenshot",function(e){e.preventDefault(),modular.updateScreenshot($(this).data("rack-id"))}),$("#form-search").submit(function(e){e.preventDefault(),modular.findRacks()}),$("#btn-reset-search").click(function(e){e.preventDefault(),$("#form-search").find("input[type=text]").val(""),$("#form-search").find("input[type=number]").val(""),$("#form-search").submit()}),$("#btn-reset-rack-name").click(function(e){e.preventDefault(),$("#SearchName").val(""),$("#form-search").submit()}),$("#search-result").on("click","#lnk-next-results",function(e){e.preventDefault(),modular.findRacks($("#lnk-next-results").attr("href"))}),$("#search-order").on("click","a",function(e){e.preventDefault(),modular.rtd.searchOrder==$(this).data("search-order")&&("asc"==modular.rtd.searchDirection?modular.rtd.searchDirection="desc":modular.rtd.searchDirection="asc"),modular.rtd.searchOrder=$(this).data("search-order"),modular.setOrderLinkActive(),modular.findRacks()}),modular.observeNavSet();const searchParamsDefault=modular.getInlineJsonData("search-params-default");modular.rtd.searchOrder=searchParamsDefault.order,modular.rtd.searchDirection=searchParamsDefault.direction,modular.setOrderLinkActive(),modular.enableEndlessScroll(function(){modular.disableEndlessScroll(),modular.findRacks($("#lnk-next-results").attr("href"))}),modular.updateSearchResultCounter()},command_center:function(){modular.rtd.racks=modular.getInlineJsonData("user-racks"),modular.updateScreenshots(),$(".li-screenshot").on("mouseenter mouseleave",function(e){$(this).find(".command-center-btns").toggleClass("visibility-hidden")}),$(".btn-get-screenshot").on("click",function(e){e.preventDefault(),modular.updateScreenshot($(this).data("rack-id"))})},add:function(){racks.edit()},edit:function(){$("#RackRows").on("change",function(e){modular.show1UCheckboxes(this.value)}),modular.show1UCheckboxes($("#RackRows").attr("value")),$("#cbrows1u").removeClass("hidden")},similar_racks:function(){modular.rtd.racks=modular.getInlineJsonData("similar-racks"),modular.updateScreenshots(),$(".li-screenshot").on("mouseenter mouseleave",function(e){$(this).find(".command-center-btns").toggleClass("visibility-hidden")}),$(".btn-get-screenshot").on("click",function(e){e.preventDefault(),modular.updateScreenshot($(this).data("rack-id"))})},view:function(){$.extend(modular.rtd,modular.getInlineJsonData("rtd")),modular.initRack(),modular.initGuidesCanvas();var settings=modular.getInlineJsonData("settings"),kbdShortcutsState=settings.kbdShortcutsState,popoverState=settings.popoverState,spaceguidesState=settings.spaceguidesState,panelselectorState=settings.panelselectorState,lockState=settings.lockState,rackIsEditable=settings.rackIsEditable,screenshotUrl=settings.screenshotUrl;modular.rtd.rackIsEditable=rackIsEditable,1===kbdShortcutsState&&modular.enableKbdShortcuts(0),1===popoverState&&modular.enablePopover(0),1===spaceguidesState&&modular.enableSpaceguides(0),1===panelselectorState&&modular.enablePanelselector(0),modular.observePanelSelectorBtns(),$("#OptionKbdShortcutsState").on("change",function(e){e.preventDefault(),0==modular.rtd.kbdShortcutsEnabled?modular.enableKbdShortcuts(1):modular.disableKbdShortcuts()}),$("#OptionPopoverState").on("change",function(e){e.preventDefault(),0==modular.rtd.popoverEnabled?modular.enablePopover(1):modular.disablePopover()}),$("#OptionSpaceguidesState").on("change",function(e){e.preventDefault(),0==modular.rtd.spaceguidesEnabled?modular.enableSpaceguides(1):modular.disableSpaceguides()}),$("#OptionPanelselectorState").on("change",function(e){e.preventDefault(),0==modular.rtd.panelselectorEnabled?modular.enablePanelselector(1):modular.disablePanelselector()}),$("#OptionLockState").on("change",function(e){e.preventDefault(),0==modular.rtd.lockEnabled?modular.enableLock(1):modular.disableLock()}),modular.observeInfoBtn(),modular.observeModuleZoomBtn(),$("#lnk-copy-to-clipboard").on("click",function(e){e.preventDefault();var text=screenshotUrl;modular.copyToClipboard(text)&&modular.flatAlert("Copied Screenshot URL to Clipboard: "+text,"alert-success")}),rackIsEditable?($("#search-result").on("click",".add-module",function(e){e.preventDefault(),0==modular.rtd.lockEnabled?modular.addModuleToRack($(this).closest(".box-module")):(window.location="#top",modular.flatAlert('<i class="icon-lock"></i> Rack is locked'))}),modular.enableDroppable(),modular.observeDeleteBtn(),modular.observeRotateBtn(),navigation.enclosingTab("Rack"),modules.browser(),1===lockState&&modular.enableLock(0)):$("#discussion").removeClass("hidden"),forums.getRequestedThread(settings.threadId)},minimal:function(){$.extend(modular.rtd,modular.getInlineJsonData("rtd")),modular.initRack()},synth:function(){createAudioContext(),audioContext.onstatechange=function(){console.log("AudioContext State changed to",audioContext.state),mg.checkAudioContext()},mg.checkAudioContext(),$("#btn-enable-audio-api").on("click",function(e){e.preventDefault(),"suspended"==audioContext.state?audioContext.resume().then(function(){mg.setAudioApiBtnActive(!1),console.log("Playback resumed successfully")}):audioContext.suspend().then(function(){mg.setAudioApiBtnActive(!0),console.log("Playback suspended")})}),$("#kinetic").on("mousedown",function(e){e.preventDefault()});var settings=modular.getInlineJsonData("settings");mg.init(settings),$("#btn-save").on("click",function(e){e.preventDefault(),mg.overwritePatch(settings.presetId)}),$("#btn-toggle-synth-popover").on("click",function(e){e.preventDefault(),!1===mg.config.widgetInfoEnabled?mg.enableSynthPopover():mg.disableSynthPopover()}),mg.enableSynthPopover(),$("#allpresets").on("click",".paging a",function(e){e.preventDefault();var url=$(this).attr("href");modular.getHtmlViaAjax(url,"#allpresets")})}},socialtopes={index:function(){var settings=modular.getInlineJsonData("settings");window.filters={service:""},social.showLoader(),social.init({config:{domain:settings.domain,webroot:settings.webroot},$:{container:$("#container"),tabbedList:$("#tabbedlist"),tabContent:$("#tab-content"),filterGroupChannel:$(".filter[data-filter-group=channel]"),resetFilterGroupChannel:$("#lnk-reset-filter-group-channel")}}),social.buildBaseUrl(),social.observeButtons(),$("#lnk-facebook").trigger("click"),$("#box-paginator").on("click","#lnk-next-results",function(e){e.preventDefault(),social.getPosts()}),$("#btn-toggle-news-filter").on("click",function(e){e.preventDefault(),0==social.rtd.filterEnabled?($("#btn-toggle-news-filter").button("toggle"),$("#btn-toggle-news-filter").button("on"),$("#btn-toggle-news-filter").addClass("btn-primary"),social.rtd.filterEnabled=1,$("#nav-channel-list").removeClass("hide")):($("#btn-toggle-news-filter").button("toggle"),$("#btn-toggle-news-filter").button("reset"),$("#btn-toggle-news-filter").removeClass("btn-primary"),social.rtd.filterEnabled=0,$("#nav-channel-list").addClass("hide"),social.resetFilterGroup("channel"),delete filters.channel,social.emptyContainer(),social.getPosts())})}},users={index:function(){$("#btn-reset-user-name").click(function(e){e.preventDefault(),$("#SearchName").val(""),$("#form-search").submit()})},add:function(){var theme="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(theme="dark"),$("#g-recaptcha").attr("data-theme",theme)},edit:function(){$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")})}},vendors={edit:function(){$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")})},view:function(){$(window).load(function(){$("#search-result").isotope({itemSelector:".isotope-item",layoutMode:"fitRows"}),$("#isotope-filters").find("a").click(function(e){e.preventDefault();var selector=$(this).attr("data-filter");$("#search-result").isotope({filter:selector}),$("#isotope-filters").find("a").removeClass("btn-primary"),$(this).addClass("btn-primary")})}),modular.enableRaty(!0),modular.observeRatingBtn()}},versions={add:function(){$("#lnk-markdown-description").on("click",function(e){e.preventDefault(),$("#block-markdown").toggleClass("hidden")}),$("#VersionIsPassive").on("click",function(e){modular.setDisabledStateOfCurrentFields($(this).is(":checked"))}),modular.setDisabledStateOfCurrentFields($("#VersionIsPassive").is(":checked")),modular.observeMarkdownPreviewForFieldId("VersionText")}},navigation={enclosingTab:function(housing){function switchTab(tab){switch($("#nav-discussion").find("li").removeClass("active"),$('#nav-discussion a[href="'+tab+'"]').closest("li").addClass("active"),tab){case"#module-finder":$("#module-finder").removeClass("hidden"),$("#discussion").addClass("hidden"),$("#buildersnote").addClass("hidden");break;case"#discussion":$("#module-finder").addClass("hidden"),$("#discussion").removeClass("hidden"),$("#buildersnote").addClass("hidden");break;case"#buildersnote":$("#module-finder").addClass("hidden"),$("#discussion").addClass("hidden"),$("#buildersnote").removeClass("hidden");break;default:$("#module-finder").removeClass("hidden"),$("#discussion").addClass("hidden"),$("#buildersnote").addClass("hidden")}}function observeNoteChanges(){$("#btn-builders-note").removeClass("glow-primary"),$("#"+housing+"Comment").one("change keyup paste",function(e){$("#btn-builders-note").addClass("glow-primary")})}$("#nav-discussion").find("a").on("click",function(e){e.preventDefault(),window.location.hash=$(e.target).attr("href"),$("html,body").scrollTop(0),switchTab($(this).attr("href"))}),-1==["#module-finder","#discussion","#buildersnote"].indexOf(window.location.hash)?switchTab("#module-finder"):switchTab(window.location.hash),observeNoteChanges(),$("#btn-builders-note").on("click",function(e){e.preventDefault();var rackId=$("#"+housing+"Id").val(),data={};data[housing]={id:rackId,comment:$("#"+housing+"Comment").val()},$.ajax({url:modular.config.baseUrl+"racks/edit/"+rackId+".json",dataType:"json",method:"POST",data:data,beforeSend:function(){modular.showIndicator($("#"+housing+"EditForm"))},success:function(data){modular.hideIndicator(),observeNoteChanges()},error:function(data){modular.hideIndicator(),modular.alert(data.responseJSON.message)}})})}};
//# sourceMappingURL=modulargrid.min.js.map